---
title: RADIUS 프록시로 작동하는 NPS 계획
description: 이 항목에서는 Windows Server 2016의 네트워크 정책 서버 RADIUS 프록시 배포 계획에 대 한 정보를 제공 합니다.
manager: brianlic
ms.prod: windows-server
ms.technology: networking
ms.topic: article
ms.assetid: ca77d64a-065b-4bf2-8252-3e75f71b7734
ms.author: pashort
author: shortpatti
ms.openlocfilehash: 29a48275dfd56cbf223e0fca0c9c276f35a675cc
ms.sourcegitcommit: 6aff3d88ff22ea141a6ea6572a5ad8dd6321f199
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 09/27/2019
ms.locfileid: "71396019"
---
# <a name="plan-nps-as-a-radius-proxy"></a>RADIUS 프록시로 작동하는 NPS 계획

>적용 대상: Windows Server(반기 채널), Windows Server 2016

Nps (네트워크 정책 서버)를 RADIUS(Remote Authentication Dial-In User Service) \(RADIUS\) 프록시로 배포할 때 NPS는 네트워크 액세스 서버 또는 다른 RADIUS 프록시와 같은 RADIUS 클라이언트에서 연결 요청을 받은 후 NPS 또는 다른 RADIUS 서버를 실행 하는 서버로 이러한 연결 요청을 전달 합니다. 이러한 계획 지침을 사용 하 여 RADIUS 배포를 간소화할 수 있습니다.

이러한 계획 지침에는 NPS를 RADIUS 서버로 배포 하려는 경우는 포함 되지 않습니다. NPS를 RADIUS 서버로 배포 하는 경우 NPS는 로컬 도메인 및 로컬 도메인을 신뢰 하는 도메인에 대 한 연결 요청에 대 한 인증, 권한 부여 및 계정을 수행 합니다.

네트워크에서 RADIUS 프록시로 NPS를 배포 하기 전에 다음 지침을 사용 하 여 배포를 계획 합니다.

- NPS 구성을 계획 합니다.

- RADIUS 클라이언트를 계획 합니다.

- 원격 RADIUS 서버 그룹을 계획 합니다.

- 메시지 전달에 대 한 특성 조작 규칙을 계획 합니다.

- 연결 요청 정책을 계획 합니다.

- NPS 계정 계획

## <a name="plan-nps-configuration"></a>NPS 구성 계획

Nps를 RADIUS 프록시로 사용 하는 경우 nps는 처리를 위해 NPS 또는 다른 RADIUS 서버에 대 한 연결 요청을 전달 합니다. 따라서 NPS 프록시의 도메인 멤버 자격은 관련이 없습니다. 프록시는 사용자 계정의 전화 접속 속성에 액세스할 필요가 없기 때문에 Active Directory Domain Services \(AD DS\)에 등록할 필요가 없습니다. 또한 프록시에서 연결 요청에 대 한 권한 부여를 수행 하지 않기 때문에 NPS 프록시에서 네트워크 정책을 구성할 필요가 없습니다. NPS 프록시는 도메인 구성원이 될 수도 있고 도메인 멤버 자격이 없는 독립 실행형 서버 일 수도 있습니다.

NPS는 RADIUS 프로토콜을 사용 하 여 네트워크 액세스 서버 라고도 하는 RADIUS 클라이언트와 통신 하도록 구성 되어야 합니다. 또한 NPS가 이벤트 로그에 기록 하는 이벤트 유형을 구성할 수 있으며 서버에 대 한 설명을 입력할 수 있습니다.

### <a name="key-steps"></a>주요 단계

NPS 프록시 구성 계획 중에 다음 단계를 사용할 수 있습니다.

- NPS 프록시가 radius 클라이언트에서 RADIUS 메시지를 수신 하 고 원격 RADIUS 서버 그룹의 구성원에 게 RADIUS 메시지를 전송 하는 데 사용 하는 RADIUS 포트를 결정 합니다. 기본 UDP (사용자 데이터 그램 프로토콜) 포트는 radius 인증 메시지의 경우 1812, 1645, RADIUS 계정 메시지의 경우 UDP 포트 1813 및 1646입니다.

- NPS 프록시가 여러 네트워크 어댑터를 사용 하 여 구성 된 경우 RADIUS 트래픽이 허용 될 어댑터를 결정 합니다.

- NPS가 이벤트 로그에 기록 하도록 할 이벤트 유형을 결정 합니다. 거부 된 연결 요청, 성공한 연결 요청 또는 둘 다를 로그할 수 있습니다.

- 둘 이상의 NPS 프록시를 배포 하 고 있는지 여부를 확인 합니다. 내결함성을 제공 하려면 둘 이상의 NPS 프록시를 사용 합니다. 하나의 NPS 프록시는 기본 RADIUS 프록시로 사용 되 고 다른 하나는 백업으로 사용 됩니다. 그러면 각 RADIUS 클라이언트는 두 NPS 프록시 모두에 구성 됩니다. 기본 NPS 프록시를 사용할 수 없게 되 면 RADIUS 클라이언트는 대체 NPS 프록시로 액세스 요청 메시지를 보냅니다.

- 관리 오버 헤드를 절약 하 고 잘못 된 서버 구성을 방지 하기 위해 한 NPS 프록시 구성을 다른 NPS 프록시에 복사 하는 데 사용 되는 스크립트를 계획 합니다. NPS는 다른 NPS 프록시를 가져오기 위해 NPS 프록시 구성의 전체 또는 일부를 복사 하는 데 사용할 수 있는 Netsh 명령을 제공 합니다. Netsh 프롬프트에서 명령을 수동으로 실행할 수 있습니다. 그러나 명령 시퀀스를 스크립트로 저장 하는 경우 프록시 구성을 변경 하려는 경우 나중에 스크립트를 실행할 수 있습니다.

## <a name="plan-radius-clients"></a>RADIUS 클라이언트 계획

RADIUS 클라이언트는 무선 액세스 \(지점과 같은 VPN\) 서버, 802.1 X 가능 스위치 및 전화 접속 서버와 같은 네트워크 액세스 서버입니다. 연결 요청 메시지를 RADIUS 서버로 전달 하는 RADIUS 프록시는 RADIUS 클라이언트 이기도 합니다. NPS는 RFC 2865, "원격 인증 전화 접속 사용자 서비스 \(RADIUS\)", RFC 2866, "RADIUS 계정"에 설명 된 대로 RADIUS 프로토콜을 준수 하는 모든 네트워크 액세스 서버 및 RADIUS 프록시를 지원 합니다.

또한 두 무선 액세스 지점과 스위치 모두 802.1 X 인증을 수행할 수 있어야 합니다. EAP (확장할 수 있는 인증 프로토콜) 또는 PEAP (Protected Extensible Authentication Protocol)를 배포 하려는 경우 액세스 지점과 스위치가 EAP 사용을 지원 해야 합니다.

무선 액세스 지점에 대 한 PPP 연결의 기본 상호 운용성을 테스트 하려면 액세스 지점과 PAP (암호 인증 프로토콜)를 사용 하도록 액세스 클라이언트를 구성 합니다. 네트워크 액세스에 사용 하려는 항목을 테스트할 때까지 PEAP와 같은 추가 PPP 기반 인증 프로토콜을 사용 합니다.

### <a name="key-steps"></a>주요 단계

RADIUS 클라이언트를 계획 하는 동안 다음 단계를 사용할 수 있습니다.

- NPS에서 구성 해야 하는 Vsa (공급 업체 관련 특성)를 문서화 합니다. Nas에 Vsa가 필요한 경우 NPS에서 네트워크 정책을 구성할 때 나중에 사용할 수 있도록 VSA 정보를 기록 합니다.

- RADIUS 클라이언트와 NPS 프록시의 IP 주소를 문서화 하 여 모든 장치의 구성을 간소화 합니다. RADIUS 클라이언트를 배포 하는 경우 radius 프로토콜을 사용 하도록 구성 하 고 인증 서버로 입력 된 NPS 프록시 IP 주소를 사용 하도록 구성 해야 합니다. 그리고 RADIUS 클라이언트와 통신 하도록 NPS를 구성 하는 경우 NPS 스냅인에 RADIUS 클라이언트 IP 주소를 입력 해야 합니다.

- RADIUS 클라이언트와 NPS 스냅인에서 구성에 대 한 공유 암호를 만듭니다. Nps에서 RADIUS 클라이언트를 구성 하는 동안 NPS 스냅인에도 입력 하는 공유 암호 또는 암호를 사용 하 여 RADIUS 클라이언트를 구성 해야 합니다.

## <a name="plan-remote-radius-server-groups"></a>원격 RADIUS 서버 그룹 계획

NPS 프록시에 원격 RADIUS 서버 그룹을 구성 하는 경우 네트워크 액세스 서버와 NPS 프록시 또는 다른 RADIUS 프록시에서 수신 하는 연결 요청 메시지 중 일부 또는 모두를 전송 하는 NPS 프록시를 알려 주어 야 합니다.

NPS를 RADIUS 프록시로 사용 하 여 하나 이상의 원격 RADIUS 서버 그룹에 연결 요청을 전달할 수 있으며 각 그룹에는 하나 이상의 RADIUS 서버가 포함 될 수 있습니다. NPS 프록시가 여러 그룹으로 메시지를 전달 하도록 하려면 그룹당 하나의 연결 요청 정책을 구성 합니다. 연결 요청 정책에는 정책에 지정 된 원격 RADIUS 서버 그룹에 보낼 메시지를 NPS 프록시에 알리는 추가 정보 (예: 특성 조작 규칙)가 포함 되어 있습니다.

Nps에 대 한 Netsh 명령을 사용 하 여 원격 radius 서버 그룹을 구성 하거나, 원격 RADIUS 서버 그룹의 NPS 스냅인에서 직접 그룹을 구성 하거나, 새 연결 요청 정책 마법사를 실행 하 여 구성할 수 있습니다.

### <a name="key-steps"></a>주요 단계

원격 RADIUS 서버 그룹을 계획 하는 동안 다음 단계를 사용할 수 있습니다.

- NPS 프록시가 연결 요청을 전달할 RADIUS 서버를 포함 하는 도메인을 확인 합니다. 이러한 도메인에는 배포 하는 RADIUS 클라이언트를 통해 네트워크에 연결 하는 사용자에 대 한 사용자 계정이 포함 되어 있습니다.

- 반지름이 아직 배포 되지 않은 도메인에 새 RADIUS 서버를 추가 해야 하는지 여부를 결정 합니다.

- 원격 RADIUS 서버 그룹에 추가 하려는 RADIUS 서버의 IP 주소를 문서화 합니다.

- 만들어야 하는 원격 RADIUS 서버 그룹의 수를 결정 합니다. 경우에 따라 도메인당 하나의 원격 RADIUS 서버 그룹을 만든 다음 도메인에 대 한 RADIUS 서버를 그룹에 추가 하는 것이 좋습니다. 그러나 도메인의 사용자 계정, 많은 수의 도메인 컨트롤러 및 많은 RADIUS 서버를 포함 하는 많은 수의 사용자를 포함 하 여 한 도메인에 많은 양의 리소스가 있는 경우가 있을 수 있습니다. 또는 도메인에서 네트워크 액세스 서버와 RADIUS 서버를 서로 떨어져 있는 위치에 포함할 수 있습니다. 이러한 경우와 기타 경우에는 도메인당 원격 RADIUS 서버 그룹을 여러 개 만들 수 있습니다.

- NPS 프록시 및 원격 RADIUS 서버에서 구성에 대 한 공유 암호를 만듭니다.

## <a name="plan-attribute-manipulation-rules-for-message-forwarding"></a>메시지 전달에 대 한 특성 조작 규칙 계획

연결 요청 정책에서 구성 된 특성 조작 규칙을 사용 하 여 특정 원격 RADIUS 서버 그룹으로 전달 하려는 액세스 요청 메시지를 식별할 수 있습니다.

특성 조작 규칙을 사용 하지 않고 모든 연결 요청을 하나의 원격 RADIUS 서버 그룹으로 전달 하도록 NPS를 구성할 수 있습니다.

연결 요청을 전달 하려는 위치가 둘 이상 있는 경우에는 각 위치에 대 한 연결 요청 정책을 만든 다음 메시지를 전달 하려는 원격 RADIUS 서버 그룹을 사용 하 여 정책을 구성 해야 합니다. NPS에 전달할 메시지를 알려 주는 특성 조작 규칙 사용.

다음 특성에 대 한 규칙을 만들 수 있습니다.

- 호출 스테이션 ID입니다. NAS (네트워크 액세스 서버)의 전화 번호입니다. 이 특성의 값은 문자열입니다. 패턴 일치 구문을 사용 하 여 영역 코드를 지정할 수 있습니다.

- 호출-스테이션 ID입니다. 호출자가 사용 하는 전화 번호입니다. 이 특성의 값은 문자열입니다. 패턴 일치 구문을 사용 하 여 영역 코드를 지정할 수 있습니다.

- 사용자 이름입니다. 액세스 클라이언트가 제공한 사용자 이름으로, RADIUS 액세스 요청 메시지에서 NAS에 의해 포함 됩니다. 이 특성의 값은 일반적으로 영역 이름 및 사용자 계정 이름을 포함 하는 문자열입니다.

연결 요청의 사용자 이름에서 영역 이름을 정확 하 게 바꾸거나 변환 하려면 적절 한 연결 요청 정책에서 사용자 이름 특성에 대 한 특성 조작 규칙을 구성 해야 합니다.

### <a name="key-steps"></a>주요 단계

특성 조작 규칙을 계획 하는 동안 다음 단계를 사용할 수 있습니다.

- RADIUS 서버에 메시지를 전달 하는 논리 경로가 있는지 확인 하기 위해 프록시를 통해 원격 RADIUS 서버에 대 한 NAS에서 메시지 라우팅을 계획 합니다.

- 각 연결 요청 정책에 사용할 하나 이상의 특성을 결정 합니다.

- 각 연결 요청 정책에 사용할 특성 조작 규칙을 문서화 하 고, 메시지가 전달 되는 원격 RADIUS 서버 그룹과 규칙을 일치 시킵니다.

## <a name="plan-connection-request-policies"></a>연결 요청 정책 계획

기본 연결 요청 정책은 NPS를 RADIUS 서버로 사용 하는 경우 NPS에 대해 구성 됩니다. 추가 연결 요청 정책을 사용 하 여 보다 구체적인 조건을 정의 하 고, NPS가 원격 RADIUS 서버 그룹으로 전달 하는 메시지를 알리고, 고급 특성을 지정할 수 있습니다. 새 연결 요청 정책 마법사를 사용 하 여 공통 또는 사용자 지정 연결 요청 정책을 만들 수 있습니다.

### <a name="key-steps"></a>주요 단계

연결 요청 정책을 계획 하는 동안 다음 단계를 사용할 수 있습니다.

- RADIUS 프록시로만 작동 하는 NPS를 실행 하는 각 서버에서 기본 연결 요청 정책을 삭제 합니다.

- 각 정책에 필요한 추가 조건 및 설정을 계획 하 고,이 정보를 원격 RADIUS 서버 그룹 및 정책에 대해 계획 된 특성 조작 규칙과 결합 합니다.

- 모든 NPS 프록시에 일반적인 연결 요청 정책을 배포 하는 계획을 설계 합니다. 한 NPS에서 여러 NPS 프록시에 공통 된 정책을 만든 다음 NPS 용 Netsh 명령을 사용 하 여 다른 모든 프록시에서 연결 요청 정책 및 서버 구성을 가져옵니다.

## <a name="plan-nps-accounting"></a>NPS 계정 계획

NPS를 RADIUS 프록시로 구성 하는 경우 nps 형식 로그 파일, 데이터베이스 호환 형식 로그 파일 또는 NPS SQL Server 로깅을 사용 하 여 RADIUS 계정을 수행 하도록 구성할 수 있습니다.

이러한 로깅 형식 중 하나를 사용 하 여 계정을 수행 하는 원격 RADIUS 서버 그룹에 계정 메시지를 전달할 수도 있습니다.

### <a name="key-steps"></a>주요 단계

NPS 계정 계획 중에 다음 단계를 사용할 수 있습니다.

- NPS 프록시가 계정 서비스를 수행 하도록 할지 아니면 계정에 대 한 원격 RADIUS 서버 그룹에 계정 메시지를 전달 하도록 할지 결정 합니다.

- 다른 서버에 계정 메시지를 전달 하려는 경우 로컬 NPS 프록시 계정을 사용 하지 않도록 계획 합니다.

- 다른 서버에 계정 메시지를 전달 하려는 경우 연결 요청 정책 구성 단계를 계획 합니다. NPS 프록시에 대해 로컬 계정을 사용 하지 않도록 설정 하는 경우 해당 프록시에서 구성 하는 각 연결 요청 정책에서 계정 메시지 전달을 사용 하도록 설정 하 고 올바르게 구성 해야 합니다.

- 사용할 로깅 형식을 결정 합니다. IAS 형식 로그 파일, 데이터베이스 호환 형식 로그 파일 또는 NPS SQL Server 로깅입니다.

RADIUS 프록시로 NPS에 대 한 부하 분산을 구성 하려면 [Nps 프록시 서버 부하 분산](nps-manage-proxy-lb.md)을 참조 하세요.

