---
title: 호스팅 서비스 공급자에 대 한 보호 된 패브릭 및 차폐 VM 계획 가이드
ms.custom: na
ms.prod: windows-server
ms.topic: article
ms.assetid: 392af37f-a02d-4d40-a25d-384211cbbfdd
manager: dongill
author: nirb-ms
ms.technology: security-guarded-fabric
ms.openlocfilehash: 255429960735d70ff3a4d260bd9090b95882b6bd
ms.sourcegitcommit: 083ff9bed4867604dfe1cb42914550da05093d25
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 01/14/2020
ms.locfileid: "75949777"
---
# <a name="guarded-fabric-and-shielded-vm-planning-guide-for-tenants"></a>테 넌 트 용 보호 된 패브릭 및 차폐 VM 계획 가이드

>적용 대상: Windows Server 2019, Windows Server (반기 채널), Windows Server 2016

이 항목에서는 규정 준수 및 보안을 위해 Vm (가상 머신)을 보호 하려는 VM 소유자에 초점을 맞춘 것입니다. Vm 소유자는 호스팅 공급자의 보호 된 패브릭에서 실행 되는지 아니면 개인 보호 된 패브릭에서 실행 되는지에 관계 없이, VM 소유자는 보호 된 Vm의 보안 수준을 제어 해야 합니다. 여기에는 필요한 경우 암호를 해독 하는 기능이 유지 됩니다.

보호 된 Vm을 사용 하는 경우 다음 세 가지 영역을 고려해 야 합니다.

- Vm의 보안 수준
- 보호에 사용 되는 암호화 키
- 보호 데이터-보호 된 Vm을 만드는 데 사용 되는 중요 한 정보 

## <a name="security-level-for-the-vms"></a>Vm에 대 한 보안 수준

보호 된 Vm을 배포할 때 두 가지 보안 수준 중 하나를 선택 해야 합니다.

- 차폐 
- 암호화 지원

차폐 및 암호화 지원 Vm 모두에 연결 된 가상 TPM이 있으며 Windows를 실행 하는 Vm은 BitLocker로 보호 됩니다. 주된 차이점은 보호 된 vm은 패브릭 관리자의 액세스를 차단 하는 반면, 암호화 지원 Vm은 패브릭 관리자가 일반 VM에 대 한 액세스 권한을 동일한 수준으로 허용 하는 것입니다. 이러한 차이점에 대 한 자세한 내용은 [보호 된 패브릭 및 보호 된 vm 개요](guarded-fabric-and-shielded-vms.md)를 참조 하세요. 

손상 된 패브릭 (손상 된 관리자 포함)에서 VM을 보호 하려는 경우 보호 된 **vm** 을 선택 합니다. 패브릭 관리자 및 패브릭 자체를 신뢰할 수 없는 환경에서 사용 해야 합니다. 암호화가 지원 되는 **vm** 을 선택 하 여 미사용 암호화와 네트워크에서의 VM 암호화 (예: 실시간 마이그레이션 중)를 모두 필요로 하는 규정 준수 표시줄을 찾습니다.

암호화 지원 Vm은 패브릭 관리자를 완전히 신뢰할 수 있지만 암호화가 요구 사항을 유지 하는 환경에 이상적입니다.

보호 된 패브릭 및 동일한 Hyper-v 호스트 에서도 일반 Vm, 보호 된 Vm 및 암호화 지원 Vm을 함께 실행할 수 있습니다. 

Vm이 보호 되는지, 아니면 암호화가 지원 되는지에 따라 VM을 만들 때 선택 하는 보호 데이터에 의해 결정 됩니다. VM 소유자는 보호 데이터를 만들 때 보안 수준을 구성 합니다 ( [보호 데이터](#shielding-data) 섹션 참조).
이 선택이 완료 되 면 VM이 가상화 패브릭에 남아 있는 동안에는 변경할 수 없습니다.

## <a name="cryptographic-keys-used-for-shielded-vms"></a>보호 된 Vm에 사용 되는 암호화 키

보호 된 Vm은 암호화 된 디스크를 사용 하는 가상화 패브릭 공격 벡터와 암호화 된 다른 여러 요소를 사용 하 여 암호 해독만 가능 합니다.

- 소유자 키 – VM 소유자가 유지 관리 하는 암호화 키로, 일반적으로 마지막 수단 복구 또는 문제 해결에 사용 됩니다. VM 소유자는 안전한 위치에 소유자 키를 유지 관리 해야 합니다.
- 하나 이상의 보호자 (호스트 보호자 키)-각 보호자는 소유자가 보호 된 Vm을 실행 하는 데 사용할 수 있는 가상화 패브릭을 나타냅니다. 기업에는 보통 기본 및 DR (재해 복구) 가상화 패브릭을 모두 포함 하며, 일반적으로 보호 된 Vm을 둘 다에서 실행할 수 있는 권한을 부여 합니다. 일부 경우에는 보조 (DR) 패브릭을 공용 클라우드 공급자가 호스트할 수 있습니다. 보호 된 패브릭에 대 한 개인 키는 가상화 패브릭에 대해서만 유지 관리 되 고 공개 키는 다운로드할 수 있으며 보호자 내에 포함 됩니다. 

**소유자 키를 만들 어떻게 할까요? 있나요?** 소유자 키는 두 개의 인증서로 표시 됩니다. 암호화에 대 한 인증서 및 서명에 사용할 인증서입니다. 사용자 고유의 PKI 인프라를 사용 하 여 이러한 두 인증서를 만들거나 공용 CA (인증 기관)에서 SSL 인증서를 가져올 수 있습니다. 테스트를 위해 Windows 10 또는 Windows Server 2016부터 모든 컴퓨터에 자체 서명 된 인증서를 만들 수도 있습니다.

**얼마나 많은 소유자 키가 있어야 하나요?** 단일 소유자 키 또는 여러 소유자 키를 사용할 수 있습니다. 모범 사례는 동일한 보안, 신뢰 또는 위험 수준을 공유 하는 Vm 그룹에 대 한 단일 소유자 키와 관리 제어를 권장 합니다. 도메인에 가입 된 모든 보호 된 Vm에 대해 단일 소유자 키를 공유 하 고 도메인 관리자가 해당 소유자 키를 관리할 수 있습니다.

**호스트 보호자에 대해 내 키를 사용할 수 있나요?** 예, 호스팅 공급자에 대 한 키를 "직접" 입력 하 고 보호 된 Vm에 대해 해당 키를 사용할 수 있습니다. 이를 통해 특정 키 (호스팅 공급자 키 사용)를 사용할 수 있으며, 준수 해야 하는 특정 보안 또는 규정이 있을 때 사용할 수 있습니다. 키를 안전 하 게 보호 하기 위해 호스트 보호자 키가 소유자 키와 달라 야 합니다.

## <a name="shielding-data"></a>보호 데이터

보호 데이터는 차폐 또는 암호화 지원 Vm을 배포 하는 데 필요한 암호를 포함 합니다. 일반 Vm을 보호 된 Vm으로 변환 하는 경우에도 사용 됩니다.

보호 데이터는 보호 데이터 파일 마법사를 사용 하 여 생성 되며 VM 소유자가 보호 된 패브릭에 업로드 하는 PDK 파일에 저장 됩니다.

보호 된 Vm은 손상 된 가상화 패브릭의 공격 으로부터 보호 하는 데 도움이 되므로 관리자의 암호, 도메인 가입 자격 증명 또는 RDP 인증서와 같이 중요 한 초기화 데이터를 전달 하는 안전한 메커니즘이 필요 합니다. 가상화 패브릭 자체 또는 관리자에 게 또한 보호 데이터에는 다음이 포함 됩니다.

1. 보안 수준 – 차폐 또는 암호화-지원 됨
2. VM을 실행할 수 있는 신뢰할 수 있는 호스트 보호자의 소유자 및 목록
3. 가상 컴퓨터 초기화 데이터 (unattend.xml, RDP 인증서)
4. 가상화 환경에서 VM을 만들기 위한 신뢰할 수 있는 서명 된 템플릿 디스크 목록 

차폐 또는 암호화가 지원 되는 VM을 만들거나 기존 VM을 변환 하는 경우 중요 한 정보를 입력 하 라는 메시지가 표시 되는 대신 보호 데이터를 선택 하 라는 메시지가 표시 됩니다.

**필요한 보호 데이터 파일 수는 몇 개입니까?** 단일 보호 데이터 파일을 사용 하 여 보호 된 모든 VM을 만들 수 있습니다. 그러나 지정 된 차폐 VM에서 4 개의 항목이 서로 다른 경우에는 추가 보호 데이터 파일이 필요 합니다. 예를 들어 해당 초기 관리자 암호 및 RDP 인증서가 다르기 때문에 IT 부서에 대 한 보호 데이터 파일 하 나와 HR 학과에 대 한 다른 보호 데이터 파일이 있을 수 있습니다.

각 보호 된 VM에 대해 별도의 보호 데이터 파일을 사용 하는 것이 가능 하지만 적절 한 선택은 아니며 적절 한 이유로 수행 해야 합니다. 예를 들어 보호 된 모든 VM에 다른 관리자 암호가 필요한 경우 [Microsoft의 LAPS (로컬 관리자 암호 솔루션)](https://www.microsoft.com/download/details.aspx?id=46899)와 같은 암호 관리 서비스 또는 도구를 대신 사용 하는 것이 좋습니다.

## <a name="creating-a-shielded-vm-on-a-virtualization-fabric"></a>가상화 패브릭에서 보호 된 VM 만들기

가상화 패브릭에서 보호 된 VM을 만들기 위한 몇 가지 옵션이 있습니다 (다음은 차폐 및 암호화 지원 Vm 모두에 해당).

1. 사용자 환경에서 보호 된 VM을 만들고 가상화 패브릭에 업로드 합니다.
2. 가상화 패브릭의 서명 된 템플릿에서 새 차폐 VM 만들기
3. 기존 VM을 보호 합니다 (기존 VM은 2 세대 여야 하며 Windows Server 2012 이상 버전을 실행 해야 함).

템플릿에서 새 Vm을 만드는 것은 일반적인 방법입니다. 그러나 새 보호 된 VM을 만드는 데 사용 되는 템플릿 디스크는 가상화 패브릭에 있으므로 악의적인 패브릭 관리자 또는 패브릭에서 실행 되는 맬웨어에 의해 변조 되지 않았는지 확인 하기 위해 추가 측정값이 필요 합니다. 이 문제는 서명 된 템플릿 디스크를 사용 하 여 해결 됩니다. 즉, 서명 된 템플릿 디스크와 해당 디스크 서명은 신뢰할 수 있는 관리자 또는 VM 소유자가 만듭니다. 차폐 VM을 만들 때 템플릿 디스크의 서명은 지정 된 보호 데이터 파일에 포함 된 서명과 비교 됩니다. 보호 데이터 파일의 서명이 템플릿 디스크의 서명과 일치 하는 경우 배포 프로세스가 계속 됩니다. 일치 항목을 찾을 수 없는 경우 배포 프로세스가 중단 되 고 신뢰할 수 없는 템플릿 디스크로 인해 VM 비밀이 손상 되지 않습니다.

서명 된 템플릿 디스크를 사용 하 여 보호 된 Vm을 만들 때 다음 두 가지 옵션을 사용할 수 있습니다.

1. 가상화 공급자가 제공 하는 서명 된 기존 템플릿 디스크를 사용 합니다. 이 경우 가상화 공급자는 서명 된 템플릿 디스크를 유지 관리 합니다.
2. 서명 된 템플릿 디스크를 가상화 패브릭에 업로드 합니다. VM 소유자는 서명 된 템플릿 디스크를 유지 관리 해야 합니다. 


