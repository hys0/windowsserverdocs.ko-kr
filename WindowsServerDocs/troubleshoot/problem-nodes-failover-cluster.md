---
title: 노드를 삭제 하는 데 문제가 있습니다.
description: 이 문서에서는 활성 장애 조치 (failover) 클러스터 구성원에서 노드를 제거할 때 발생 하는 문제를 설명 합니다.
ms.prod: windows-server
ms.technology: server-general
ms.date: 05/28/2020
author: Deland-Han
ms.author: delhan
ms.openlocfilehash: 30714e8a9c5ca4ad13ed6757c6ce1da211b279ac
ms.sourcegitcommit: ef089864980a1d4793a35cbf4cbdd02ce1962054
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 05/28/2020
ms.locfileid: "84150231"
---
# <a name="having-a-problem-with-nodes-being-removed-from-active-failover-cluster-membership"></a>능동 장애 조치 (Failover) 클러스터 멤버 자격에서 제거 되는 노드에 문제가 있음

이 문서에서는 노드가 활성 장애 조치 (failover) 클러스터 멤버 자격에서 무작위로 제거 되는 문제를 해결 하는 방법을 소개 합니다.

## <a name="symptoms"></a>증상

문제가 발생 하면 시스템 이벤트 로그에 다음과 같은 이벤트가 표시 됩니다.

![이벤트 1135](media/problem-nodes-failover-cluster/1135-1.png)

이 이벤트는 제거 된 노드를 제외 하 고 클러스터의 모든 노드에 기록 됩니다. 이 이벤트의 이유는 클러스터의 노드 중 하나가 해당 노드를 중단 된 것으로 표시 했기 때문입니다. 그런 다음 이벤트의 다른 모든 노드에 알립니다. 노드에 알림이 표시 되 면 해당 노드에 하트 비트 연결을 중단 하 고 중단 된 노드로 종료 합니다.

## <a name="what-caused-the-node-to-be-marked-down"></a>노드가 다운 된 것으로 표시 된 원인

Windows 2008 또는 2008 R2 장애 조치 (Failover) 클러스터의 모든 노드는이 네트워크에서 클러스터 네트워크 통신을 허용 하도록 설정 된 네트워크를 통해 서로 통신 합니다. 노드는 이러한 네트워크를 통해 하트 비트 패킷을 다른 모든 노드에 전송 합니다. 이러한 패킷은 다른 노드에서 수신 하 고 응답을 다시 보냅니다. 클러스터의 각 노드에는 네트워크를 가동 하 고 다른 노드가 작동 하는지 확인 하기 위해 모니터링할 자체 하트 비트가 있습니다. 아래 예제에서는이를 명확 하 게 설명 합니다.

![노드](media/problem-nodes-failover-cluster/Node2.png)

이러한 패킷 중 하나가 반환 되지 않으면 특정 하트 비트가 실패 한 것으로 간주 됩니다. 예를 들어 W2K8-r 2는 요청을 보내고 W2K8-r 2에서 하트 비트 패킷으로 응답을 수신 하 여 네트워크와 노드가 작동 하는지 확인 합니다.  W2K8-r 2가 W2K8-r 2로 요청을 보내고, W2K8-r 2가 응답을 받지 못하면, 손실 된 하트 비트로 간주 되 고 W2K8-r 2는 추적을 추적 합니다.  이 누락 된 응답은 다른 하트 비트 요청을 받을 때까지 네트워크를 다운 W2K8 표시할 수 있습니다.

기본적으로 클러스터 노드는 5 초 이내에 5 초 이내에 연결의 작동이 중지 된 것으로 제한 됩니다. 따라서 W2K8-r 2가 해당 기간 내에 5 번 응답을 받지 못하면 특정 경로를 W2K8-2-2-2로 간주 합니다. 다른 경로가 여전히 작동 중인 것으로 간주 되는 경우 W2K8-r 2는 활성 멤버로 남아 있습니다.

모든 경로가 W2K8-r 2에 대해 다운 된 것으로 표시 되 면 활성 장애 조치 (Failover) 클러스터 멤버 자격에서 제거 되 고 첫 번째 섹션에서 볼 수 있는 1135 이벤트가 기록 됩니다. W2K8-r 2에서 클러스터 서비스가 종료 된 후 다시 시작 되어 클러스터에 다시 가입을 시도할 수 있습니다.

세 개 이상의 노드로 진행 되는 특정 경로를 처리 하는 방법에 대 한 자세한 내용은 Jeff Hughes에서 작성 한 ["분할 된" 클러스터 네트워크](/archive/blogs/askcore/partitioned-cluster-networks) 블로그를 참조 하세요.

## <a name="now-that-we-know-how-the-heartbeat-process-works-what-are-some-of-the-known-causes-for-the-process-to-fail"></a>하트 비트 프로세스가 작동 하는 방식을 알고 있으므로 프로세스가 실패 하는 몇 가지 알려진 원인은 무엇 인가요?

1. 실제 네트워크 하드웨어 오류입니다. 노드가 노드 간 통신에서 손실 되 면 하트 비트가 실패 합니다. 관련 된 두 노드의 네트워크 추적은이를 나타냅니다.

2. 네트워크 연결에 대 한 프로필은 도메인에서 공용으로, 다시 도메인에 다시 연결 될 수도 있습니다. 이러한 변경 내용을 전환 하는 동안 네트워크 i/o를 차단할 수 있습니다. 네트워크 프로필 작업 로그를 살펴보면이 경우에 해당 하는지 확인할 수 있습니다. 이벤트 뷰어를 열고 응용 프로그램 및 서비스 Logs\Microsoft\Windows\NetworkProfile\Operational.로 이동 하 여이 로그를 찾을 수 있습니다. 이벤트 ID: 1135에 언급 된 노드에서이 로그의 이벤트를 확인 하 고 프로필을 현재 변경 하 고 있는지 확인 합니다. 이 경우 [windows 7 또는 Windows Server 2008 r 2에서 네트워크 위치 프로필이 "도메인"에서 "공용"으로 변경 된](https://support.microsoft.com/help/2524478/the-network-location-profile-changes-from-domain-to-public-in-windows)KB 문서를 확인 합니다.

3. 서버에서 IPv6을 사용 하도록 설정 했지만 Windows 방화벽에서 인바운드 및 아웃 바운드에 대해 다음과 같은 두 가지 규칙을 사용 하지 않도록 설정 했습니다.

    - 핵심 네트워킹-네트워크 환경 검색 보급 알림
    - 핵심 네트워킹-네트워크 환경 검색 요청

4. 바이러스 백신 소프트웨어가이 프로세스를 방해할 수도 있습니다. 이 문제가 의심 되는 경우 소프트웨어를 사용 하지 않도록 설정 하거나 제거 하 여 테스트 합니다. 이 시점에서 바이러스 로부터 보호를 받을 수 있기 때문에이 작업은 사용자의 책임에서 발생 합니다.

5. 네트워크의 대기 시간으로 인해이 문제가 발생할 수도 있습니다. 노드가 노드 사이에서 손실 되지 않을 수도 있지만 제한 시간이 만료 되기 전에 노드가 충분히 빨리 이동 하지 않을 수 있습니다.

6. I p v 6은 장애 조치 (Failover) 클러스터링이 하트 비트에 사용할 기본 프로토콜입니다. 하트 비트 자체는 포트 3343을 통해 통신 하는 UDP 유니캐스트 네트워크 패킷입니다. 스위치, 방화벽 또는 라우터가이 트래픽을 허용 하도록 제대로 구성 되지 않은 경우 다음과 같은 문제가 발생할 수 있습니다.

7. IPsec 보안 정책을 새로 고치면이 문제가 발생할 수도 있습니다. 특정 문제는 IPSec 그룹 정책을 업데이트 하는 동안 모든 IPsec Sa (보안 연결)가 Windows 방화벽에 대 한 고급 보안이 포함 된 Windows 방화벽에서 중단 되는 것입니다. 이 문제가 발생 하는 동안 모든 네트워크 연결이 차단 됩니다. Active Directory를 사용 하 여 인증을 수행 하는 데 지연이 발생 하는 경우 보안 연결을 renegotiating 때 이러한 지연 (모든 네트워크 통신이 차단 됨)은 클러스터 하트 비트가 검색 되지 않도록 차단 하 고 클러스터 상태 모니터링이 5 초 임계값 내에 응답 하지 않을 경우 노드를 중단 된 것으로 검색 하도록 합니다.

8. 이전 또는 최신 네트워크 카드 드라이버 및/또는 펌웨어  때때로 네트워크 카드나 스위치의 단순한 잘못 된 구성으로 인해 하트 비트가 손실 될 수도 있습니다.

9. 최신 네트워크 카드 및 가상 네트워크 카드에 패킷 손실이 발생 했을 수 있습니다.  이는 성능 모니터를 열고 "Network Interface\Packets Received 버렸습니다" 카운터를 추가 하 여 추적할 수 있습니다.  이 카운터는 누적 되며 서버가 다시 부팅 될 때 까지만 늘어납니다.  여기에서 삭제 된 많은 패킷이 표시 되는 것은 네트워크 카드의 수신 버퍼가 너무 낮게 설정 되었거나 서버가 느리게 작동 하 고 인바운드 트래픽을 처리할 수 없음을 나타내는 것일 수 있습니다.  각 네트워크 카드 제조업체는 네트워크 카드의 속성에 이러한 설정을 표시할지 여부를 선택 하므로 제조업체의 웹 사이트를 참조 하 여 이러한 값을 늘리는 방법을 알아보고 권장 값을 사용 해야 합니다.  VMware에서를 실행 하는 경우 다음 블로그는이 문제 인지 여부를 확인 하는 방법을 비롯 하 여이에 대 한 자세한 정보를 제공 하며, 변경할 설정에 대 한 VMWare 문서를 가리킵니다.

    [VMWare ESX의 장애 조치 (Failover) 클러스터 구성원에서 제거 되는 노드](/archive/blogs/askcore/nodes-being-removed-from-failover-cluster-membership-on-vmware-esx)

이러한 이벤트가 기록 되는 가장 일반적인 이유는 무엇 이지만 다른 이유가 있을 수도 있습니다. 이 블로그는 프로세스에 대 한 몇 가지 정보를 제공 하 고 검색할 항목의 아이디어를 제공 하는 것입니다. 일부는이 문제를 해결 하기 위해 다음 값을 최 댓 값으로 올립니다.

|매개 변수|기본값|범위|
|---|---|---|
|**SameSubnetDelay**|1000 밀리초|250-2000 밀리초|
|**CrossSubnetDelay**|1000 밀리초|250-4000 밀리초|
|**SameSubnetThreshold**|5|3-10|
|**CrossSubnetThreshold**|5|3-10|
||||

이러한 값을 최대 값으로 높이면 이벤트와 노드 제거를 벗어날 수 있으며 문제를 마스킹하는 것입니다. 아무것도 수정 되지 않습니다. 가장 좋은 방법은 하트 비트 실패의 근본 원인을 발견 하 여 수정 하는 것입니다. 이러한 값을 증가 시키기 위한 실질적인 요구는 노드가 서로 다른 위치에 상주 하 고 네트워크 대기 시간을 극복 하지 못하는 다중 사이트 시나리오에 있습니다.
