---
ms.assetid: 342173ca-4e10-44f4-b2c9-02a6c26f7a4a
title: 스토리지 공간 다이렉트에서 볼륨 계획
ms.prod: windows-server
ms.author: cosdar
manager: eldenc
ms.technology: storage-spaces
ms.topic: article
author: cosmosdarwin
ms.date: 06/28/2019
ms.localizationpriority: medium
ms.openlocfilehash: d5c45b68f18fe3126867a9b6608b0911bb3f63b2
ms.sourcegitcommit: 771db070a3a924c8265944e21bf9bd85350dd93c
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/27/2020
ms.locfileid: "85474760"
---
# <a name="planning-volumes-in-storage-spaces-direct"></a>스토리지 공간 다이렉트에서 볼륨 계획

> 적용 대상: Windows Server 2019, Windows Server 2016

이 항목에서는 파일 시스템, 복원 력 유형 및 크기를 선택 하는 것을 포함 하 여 워크 로드의 성능 및 용량 요구에 맞게 스토리지 공간 다이렉트에서 볼륨을 계획 하는 방법에 대 한 지침을 제공 합니다.

## <a name="review-what-are-volumes"></a>검토: 볼륨 이란?

볼륨은 Hyper-v 가상 컴퓨터에 대 한 VHD 또는 VHDX 파일과 같이 워크 로드에 필요한 파일을 배치 하는 위치입니다. 볼륨은 저장소 풀의 드라이브를 결합 하 여 스토리지 공간 다이렉트의 내결함성, 확장성 및 성능 이점을 도입 합니다.

   >[!NOTE]
   > 스토리지 공간 다이렉트에 대 한 전체 설명서에서는 "볼륨" 이라는 용어를 사용 하 여 CSV (클러스터 공유 볼륨) 및 ReFS와 같은 다른 기본 제공 Windows 기능에서 제공 하는 기능을 비롯 하 여 그 아래의 볼륨 및 가상 디스크를 공동으로 참조 합니다. 이러한 구현 수준 차이를 이해 하는 것은 스토리지 공간 다이렉트 성공적으로 계획 하 고 배포할 필요가 없습니다.

![볼륨](media/plan-volumes/what-are-volumes.png)

모든 볼륨은 클러스터의 모든 서버에서 동시에 액세스할 수 있습니다. 만든 후에는 모든 서버의 **C:\clusterstorage \\ ** 에 표시 됩니다.

![csv-폴더-스크린샷](media/plan-volumes/csv-folder-screenshot.png)

## <a name="choosing-how-many-volumes-to-create"></a>만들 볼륨 수 선택

볼륨 수를 클러스터에 있는 서버 수의 배수로 만드는 것이 좋습니다. 예를 들어 서버가 4 개 있는 경우 3 또는 5 개 보다 4 개의 총 볼륨을 통해 보다 일관 된 성능을 경험할 수 있습니다. 이렇게 하면 클러스터에서 서버 간에 균등 하 게 "소유권" (각 볼륨에 대 한 메타 데이터 오케스트레이션을 처리 하는 하나의 서버)을 배포할 수 있습니다.

볼륨의 총 수를 다음으로 제한 하는 것이 좋습니다.

| Windows Server 2016          | Windows Server 2019          |
|------------------------------|------------------------------|
| 클러스터 당 최대 32 볼륨 | 클러스터 당 최대 64 볼륨 |

## <a name="choosing-the-filesystem"></a>파일 시스템 선택

스토리지 공간 다이렉트에 대해 새 [ReFS (복원 파일 시스템)](../refs/refs-overview.md) 를 사용 하는 것이 좋습니다. ReFS는 가상화를 위해 작성 된 프리미어 파일 시스템 용도로, 뛰어난 성능 가속 및 데이터 손상에 대 한 기본 제공 보호를 포함 하 여 다양 한 이점을 제공 합니다. Windows Server 버전 1709 이상에서 데이터 중복 제거를 포함 하 여 거의 모든 키 NTFS 기능을 지원 합니다. 자세한 내용은 ReFS [기능 비교 표](../refs/refs-overview.md#feature-comparison) 를 참조 하세요.

워크 로드에 ReFS에서 아직 지원 하지 않는 기능이 필요한 경우 NTFS를 대신 사용할 수 있습니다.

   > [!TIP]
   > 서로 다른 파일 시스템의 볼륨은 동일한 클러스터에 공존할 수 있습니다.

## <a name="choosing-the-resiliency-type"></a>복원 력 유형 선택

스토리지 공간 다이렉트 볼륨은 드라이브 또는 서버 오류와 같은 하드웨어 문제 로부터 보호 하 고 소프트웨어 업데이트와 같은 서버 유지 관리를 통해 지속적인 가용성을 제공 하는 복원 력을 제공 합니다.

   > [!NOTE]
   > 선택할 수 있는 복원 력 유형은 보유 한 드라이브 유형과 무관 합니다.

### <a name="with-two-servers"></a>서버 2 대

클러스터에 두 개의 서버가 있으면 양방향 미러링을 사용할 수 있습니다. Windows Server 2019를 실행 하는 경우 중첩 된 복원 력을 사용할 수도 있습니다.

양방향 미러링은 모든 데이터의 복사본 두 개를 각 서버에 있는 드라이브에 하나씩 보관 합니다. 저장소 효율성은 50% 이며 1TB의 데이터를 쓰려면 저장소 풀에서 2tb 이상의 실제 저장소 용량이 필요 합니다. 양방향 미러링은 한 번에 하나의 하드웨어 오류를 안전 하 게 허용할 수 있습니다 (하나의 서버 또는 드라이브).

![양방향 미러](media/plan-volumes/two-way-mirror.png)

중첩 된 복원 력 (Windows Server 2019 에서만 사용 가능)은 양방향 미러링을 사용 하는 서버 간에 데이터 복원 력을 제공 하 고 양방향 미러링 또는 미러 가속 패리티를 사용 하 여 서버 내에 복원 력을 추가 합니다. 중첩은 한 서버를 다시 시작 하거나 사용할 수 없는 경우에도 데이터 복원 력을 제공 합니다. 중첩 된 미러링 가속화 된 패리티의 경우 35-40%의 중첩 된 양방향 미러링의 저장소 효율성이 25%입니다. 중첩 된 복원 력은 한 번에 두 개의 하드웨어 오류를 안전 하 게 허용할 수 있습니다 (두 개의 드라이브 또는 서버와 나머지 서버에서 드라이브). 이러한 데이터 복원 력이 추가 되었기 때문에 Windows Server 2019를 실행 하는 경우 두 서버 클러스터의 프로덕션 배포에 중첩 된 복원 력을 사용 하는 것이 좋습니다. 자세한 내용은 [중첩 된 복원 력](nested-resiliency.md)을 참조 하세요.

![중첩 된 미러 가속 패리티](media/nested-resiliency/nested-mirror-accelerated-parity.png)

### <a name="with-three-servers"></a>서버 3 대

3 개의 서버를 사용 하는 경우에는 내결함성 및 성능 향상을 위해 3 방향 미러링을 사용 해야 합니다. 3 방향 미러링은 모든 데이터의 복사본 세 개를 각 서버의 드라이브에 한 번에 보관 합니다. 저장소 효율성이 33.3% – 1TB의 데이터를 쓰려면 저장소 풀에서 최소 3TB의 실제 저장소 용량이 필요 합니다. 3 방향 미러링은 [한 번에 두 개 이상의 하드웨어 문제 (드라이브 또는 서버)](storage-spaces-fault-tolerance.md#examples)를 안전 하 게 허용할 수 있습니다. 2 개의 노드를 사용할 수 없는 경우 2/3 디스크를 사용할 수 없으므로 저장소 풀에서 쿼럼이 손실 되 고 가상 디스크가 액세스할 수 없습니다 됩니다. 그러나 노드가 다운 되 고 하나 이상의 디스크가 다른 노드에 실패할 수 있으며 가상 디스크는 온라인 상태로 유지 됩니다. 예를 들어, 갑자기 다른 드라이브나 서버에 오류가 발생할 때 한 서버를 다시 부팅 하는 경우 모든 데이터는 안전 하 게 유지 되 고 지속적으로 액세스할 수 있습니다.

![3 방향 미러](media/plan-volumes/three-way-mirror.png)

### <a name="with-four-or-more-servers"></a>서버 4 개 이상

서버를 4 개 이상 사용 하는 경우 각 볼륨에 대해 3 방향 미러링과 이중 패리티 ("지우기 코딩"이 라고도 함)를 사용할지 아니면 미러 가속 패리티를 혼합 하 여 선택할 수 있습니다.

이중 패리티는 3 방향 미러링과 동일한 내결함성을 제공 하지만 저장소 효율성이 향상 됩니다. 4 대의 서버에서 저장소 효율성이 50.0% — 2tb의 데이터를 저장 하려면 저장소 풀에서 2tb의 물리적 저장소 용량이 필요 합니다. 이는 7 대의 서버를 사용 하 여 66.7% 저장소 효율성을 높이고 저장소 효율성을 최대 80.0%까지 계속 합니다. 이는 패리티 인코딩이 더 많은 계산 집약적 이므로 성능을 제한할 수 있다는 것입니다.

![이중 패리티](media/plan-volumes/dual-parity.png)

사용할 복원 력 유형은 워크 로드의 요구 사항에 따라 달라 집니다. 각 복원 력 유형에 적합 한 워크 로드 및 각 복원 력 유형의 성능 및 저장소 효율성을 요약 하는 표는 다음과 같습니다.

| 복원 유형 | 용량 효율성 | 속도 | 워크로드 |
| ------------------- | ----------------------  | --------- | ------------- |
| **미러**         | ![33%를 표시 하는 저장소 효율성](media/plan-volumes/3-way-mirror-storage-efficiency.png)<br>3 방향 미러: 33% <br>양방향 미러: 50%     |![100%를 보여 주는 성능](media/plan-volumes/three-way-mirror-perf.png)<br> 최고 성능  | 가상화 된 워크 로드<br> 데이터베이스<br>기타 고성능 워크 로드 |
| **미러 가속 패리티** |![50%를 보여 주는 저장소 효율성](media/plan-volumes/mirror-accelerated-parity-storage-efficiency.png)<br> 미러 및 패리티의 비율에 따라 달라 집니다. | ![20% 주위에 표시 되는 성능](media/plan-volumes/mirror-accelerated-parity-perf.png)<br>미러 속도 보다 훨씬 느리지만 이중 패리티와 최대 2 배<br> 대량 순차 쓰기 및 읽기에 적합 | 보관 및 백업<br> 가상화 된 데스크톱 인프라     |
| **이중 패리티**               | ![80%를 보여 주는 저장소 효율성](media/plan-volumes/dual-parity-storage-efficiency.png)<br>4 서버: 50% <br>16 대의 서버: 최대 80% | ![약 10%를 표시 하는 성능](media/plan-volumes/dual-parity-perf.png)<br>쓰기에 대 한 CPU 사용량 & 최고 i/o 대기 시간<br> 대량 순차 쓰기 및 읽기에 적합 | 보관 및 백업<br> 가상화 된 데스크톱 인프라  |

#### <a name="when-performance-matters-most"></a>성능이 가장 중요 한 경우

엄격한 대기 시간 요구 사항이 있거나 SQL Server 데이터베이스 또는 성능이 중요 한 Hyper-v 가상 머신과 같이 많은 혼합 된 임의 IOPS가 필요한 워크 로드는 미러링을 사용 하 여 성능을 최대화 하는 볼륨에서 실행 해야 합니다.

   >[!TIP]
   > 미러링은 다른 복원 력 유형 보다 빠릅니다. 거의 모든 성능 예제에 대해 미러링을 사용 합니다.

#### <a name="when-capacity-matters-most"></a>용량이 가장 많은 경우

데이터 웨어하우스 또는 "콜드" 저장소와 같이 자주 작성 하는 작업은 저장소 효율성을 최대화 하기 위해 이중 패리티를 사용 하는 볼륨에서 실행 되어야 합니다. 기존 파일 서버, VDI (가상 데스크톱 인프라) 또는 많은 고속 유동 임의 IO 트래픽을 만들지 않는 다른 작업 (예: 기존 파일 서버, VDI (가상 데스크톱 인프라)) 또는 최상의 성능이 필요 하지 않은 다른 작업은 신중 하 게 이중 패리티를 사용할 수도 있습니다. 패리티를 사용 하면 특히 미러링에 비해 CPU 사용률 및 IO 대기 시간이 증가 합니다.

#### <a name="when-data-is-written-in-bulk"></a>데이터를 대량으로 작성 하는 경우

보관 또는 백업 대상과 같은 대규모 순차적 패스에서 작성 하는 워크 로드에는 Windows Server 2016에 새로 포함 된 다른 옵션이 있습니다. 즉, 한 볼륨이 미러링 및 이중 패리티를 혼합할 수 있습니다. 첫 번째 위치를 미러된 부분에 쓰고 나중에 패리티 부분으로 점차적으로 이동 합니다. 이렇게 하면 계산 집약적 패리티 인코딩이 더 오래 걸릴 수 있으므로 대량 쓰기가 도착할 때 리소스 사용률을 가속화 하 고 리소스 사용률을 줄입니다. 부분 크기를 조정 하는 경우 한 번에 발생 하는 쓰기의 양 (예: 하루에 한 번 백업)은 미러 부분에 맞게 조정 해야 합니다. 예를 들어 매일 100 g b를 수집 하는 경우 150 GB에서 200 GB로 미러링을 사용 하 고 나머지에는 이중 패리티를 사용 하는 것이 좋습니다.

결과적으로 저장소 효율성은 선택한 비율에 따라 달라 집니다. 몇 가지 예제는 [이 데모](https://www.youtube.com/watch?v=-LK2ViRGbWs&t=36m55s) 를 참조 하세요.

   > [!TIP]
   > 데이터 수집을 통해 쓰기 성능 걸리거나 급격 한 감소를 관찰 하는 경우 미러 부분이 충분히 크지 않거나 사용자의 사용 사례에 대해 미러 가속 패리티가 적합 하지 않다는 것을 나타낼 수 있습니다. 예를 들어 쓰기 성능이 400 m b/초에서 40 m b/초로 감소 하는 경우 미러 부분을 확장 하거나 3 방향 미러로 전환 하는 것이 좋습니다.

### <a name="about-deployments-with-nvme-ssd-and-hdd"></a>NVMe, SSD 및 HDD를 사용한 배포 정보

두 가지 유형의 드라이브가 있는 배포에서 더 빠른 드라이브는 캐싱을 제공 하지만 속도가 느린 드라이브는 용량을 제공 합니다. 이는 자동으로 수행 됩니다. 자세한 내용은 [스토리지 공간 다이렉트 캐시 이해](understand-the-cache.md)를 참조 하십시오. 이러한 배포에서 모든 볼륨은 궁극적으로 동일한 유형의 드라이브 (용량 드라이브)에 상주 합니다.

3 가지 유형의 드라이브가 모두 포함 된 배포에서는 가장 빠른 드라이브 (NVMe)만 캐싱을 제공 하 고 두 가지 유형의 드라이브 (SSD 및 HDD)를 유지 하 여 용량을 제공 합니다. 각 볼륨에 대해 완전히 SSD 계층에 있든, 완전히 HDD 계층에 있든, 둘의 범위에 포함 되는지 여부를 선택할 수 있습니다.

   > [!IMPORTANT]
   > SSD 계층을 사용 하 여 가장 성능이 중요 한 워크 로드를 모든 플래시에 저장 하는 것이 좋습니다.

## <a name="choosing-the-size-of-volumes"></a>볼륨 크기 선택

각 볼륨의 크기를 다음으로 제한 하는 것이 좋습니다.

| Windows Server 2016 | Windows Server 2019 |
| ------------------- | ------------------- |
| 최대 32 TB         | 최대 64 TB         |

   > [!TIP]
   > 파일 서버 작업에 일반적으로 사용 되는 VSS (볼륨 섀도 복사본 서비스) 및 Volsnap 소프트웨어 공급자를 사용 하는 백업 솔루션을 사용 하는 경우, 볼륨 크기를 10TB로 제한 하면 성능과 안정성이 향상 됩니다. 최신 Hyper-v .RCT API 및/또는 ReFS 블록 복제 및/또는 네이티브 SQL 백업 Api를 사용 하는 백업 솔루션은 32 TB 이상에서 잘 작동 합니다.

### <a name="footprint"></a>공간

볼륨의 크기는 사용할 수 있는 용량, 저장할 수 있는 데이터의 양을 나타냅니다. 이 매개 변수는 **새 볼륨** cmdlet의 **-size** 매개 변수를 통해 제공 된 다음, **Get 볼륨** cmdlet을 실행할 때 **size** 속성에 나타납니다.

크기는 볼륨의 *공간과*다르며 저장소 풀에서 사용 하는 총 실제 저장소 용량입니다. 사용 공간은 복원 력 유형에 따라 달라 집니다. 예를 들어 3 방향 미러링을 사용 하는 볼륨의 크기는 세 배입니다.

볼륨의 차지은 저장소 풀에 맞게 조정 해야 합니다.

![크기와 공간 비교](media/plan-volumes/size-versus-footprint.png)

### <a name="reserve-capacity"></a>예약 용량

저장소 풀의 일부 용량을 그대로 유지 하면 드라이브에 오류가 발생 한 후에 "내부"를 복구 하는 볼륨 공간을 확보 하 여 데이터 보안 및 성능을 향상 시킬 수 있습니다. 용량이 충분 한 경우 즉시 병렬 복구를 수행 하면 오류가 발생 한 드라이브가 교체 되기 전에도 전체 복원 력으로 볼륨을 복원할 수 있습니다. 이는 자동으로 수행 됩니다.

서버당 하나의 용량 드라이브 (최대 4 개의 드라이브)를 예약 하는 것이 좋습니다. 사용자의 재량에 따라 더 많은 시간을 예약할 수 있지만이 최소 권장 사항은 드라이브 실패 후 즉시 병렬 복구가 성공할 수 있도록 보장 합니다.

![reserve](media/plan-volumes/reserve.png)

예를 들어 두 대의 서버가 있고 1TB 용량 드라이브를 사용 하는 경우 예약으로 풀의 2 x 1 = 2tb를 따로 설정 합니다. 3 개의 서버와 1TB 용량 드라이브가 있는 경우 예약으로 3 x 1 = 3TB를 따로 설정 합니다. 하나 이상의 서버 및 1TB 용량 드라이브가 있는 경우 예약으로 4 x 1 = 4 TB를 따로 설정 합니다.

   >[!NOTE]
   > 3 가지 유형의 드라이브가 모두 포함 된 클러스터 (NVMe + SSD + HDD)에서 서버당 최대 4 대의 드라이브를 포함 하는 단일 SSD와이에 해당 하는 HDD를 예약 하는 것이 좋습니다.

## <a name="example-capacity-planning"></a>예: 용량 계획

1 4-서버 클러스터를 고려 합니다. 각 서버에는 용량에 대 한 일부 캐시 드라이브와 16 개의 2TB 드라이브가 있습니다.

```
4 servers x 16 drives each x 2 TB each = 128 TB
```

저장소 풀의이 128 TB부터 4 개의 드라이브 또는 8tb를 설정 하 여 실패 한 후 드라이브를 교체 하지 않고도 전체 복구를 수행할 수 있습니다. 그러면 볼륨을 만들 수 있는 풀에서 120 TB의 실제 저장소 용량이 남게 됩니다.

```
128 TB – (4 x 2 TB) = 120 TB
```

모든 활성 Hyper-v 가상 컴퓨터를 호스트 하는 배포가 필요 하지만, 유지 해야 하는 많은 콜드 저장소 (이전 파일 및 백업)도 포함 하 고 있다고 가정 합니다. 서버 4 대가 있기 때문에 4 개의 볼륨을 만들어 보겠습니다.

*Volume1* 및 *Volume2*처음 두 볼륨에 가상 컴퓨터를 배치 해 보겠습니다. ReFS를 파일 시스템 (더 빠른 생성 및 검사점)으로 선택 하 고 복원 력을 위한 3 방향 미러링을 선택 하 여 성능을 최대화 합니다. 다른 두 볼륨, *볼륨 3* 및 *볼륨 4*에 콜드 저장소를 배치 해 보겠습니다. NTFS를 파일 시스템 (데이터 중복 제거의 경우) 및 복원 력을 위한 이중 패리티 (용량 최대화)로 선택 합니다.

모든 볼륨의 크기를 동일 하 게 지정 해야 하는 것은 아니지만 간단 하 게 하기 위해 예를 들어 12 TB를 모두 만들 수 있습니다.

*Volume1* 및 *Volume2* 는 각각 12tb x 33.3%의 효율성 = 36 tb의 실제 저장소 용량을 차지 합니다.

*Volume3* 및 *Volume4* 는 각각 12tb x 50.0%의 효율성 = 24 tb의 실제 저장소 용량을 차지 합니다.

```
36 TB + 36 TB + 24 TB + 24 TB = 120 TB
```

4 개 볼륨이 풀에서 사용할 수 있는 실제 저장소 용량에 정확히 맞습니다. 꼭!

![예제](media/plan-volumes/example.png)

   >[!TIP]
   > 모든 볼륨을 즉시 만들 필요는 없습니다. 볼륨을 항상 확장 하거나 나중에 새 볼륨을 만들 수 있습니다.

편의상이 예제에서는 1TB = 1조 바이트를 의미 하는 10 진수 (밑수 10) 단위를 사용 합니다. 그러나 Windows의 저장소 수량은 이진 (밑 2) 단위로 표시 됩니다. 예를 들어 각 2tb 드라이브는 Windows에서 1.82 TiB로 표시 됩니다. 마찬가지로 128 TB 저장소 풀은 116.41 TiB 표시 됩니다. 예상된 동작입니다.

## <a name="usage"></a>사용량

[스토리지 공간 다이렉트에서 볼륨 만들기를](create-volumes.md)참조 하세요.

### <a name="additional-references"></a>추가 참조

- [스토리지 공간 다이렉트 개요](storage-spaces-direct-overview.md)
- [스토리지 공간 다이렉트 드라이브 선택](choosing-drives.md)
- [내결함성 및 스토리지 효율성](storage-spaces-fault-tolerance.md)
