---
ms.assetid: 342173ca-4e10-44f4-b2c9-02a6c26f7a4a
title: 저장소 공간 다이렉트에서 볼륨 계획
ms.prod: windows-server
ms.author: cosdar
ms.manager: eldenc
ms.technology: storage-spaces
ms.topic: article
author: cosmosdarwin
ms.date: 06/28/2019
ms.localizationpriority: medium
ms.openlocfilehash: 52c600068d5dd447ff9faa7c40788664e222a83a
ms.sourcegitcommit: 0a0a45bec6583162ba5e4b17979f0b5a0c179ab2
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 03/13/2020
ms.locfileid: "79322785"
---
# <a name="planning-volumes-in-storage-spaces-direct"></a>저장소 공간 다이렉트에서 볼륨 계획

> 적용 대상: Windows Server 2019, Windows Server 2016

이 항목에서는 파일 시스템, 복원력 유형 및 크기 선택을 포함하여 작업에 대한 성능 및 용량 요구 사항을 충족하기 위해 저장소 공간 다이렉트에서 볼륨을 계획하는 방법에 대한 지침을 제공합니다.

## <a name="review-what-are-volumes"></a>검토: 볼륨이란?

볼륨은 Hyper-v 가상 컴퓨터에 대 한 VHD 또는 VHDX 파일과 같이 워크 로드에 필요한 파일을 배치 하는 위치입니다. 볼륨은 저장소 풀의 드라이브를 결합하여 저장소 공간 다이렉트의 내결함성, 확장성 및 성능 이점을 도입합니다.

   >[!NOTE]
   > 저장소 공간 다이렉트에 대한 설명서에서는 CSV(클러스터 공유 볼륨) 및 ReFS와 같은 다른 기본 제공 Windows 기능을 비롯하여 저장소 공간 다이렉트에 속하는 볼륨 및 가상 디스크를 공동으로 참조하기 위해 전체적으로 "볼륨"이라는 용어를 사용하고 있습니다. 저장소 공간 다이렉트를 계획하고 배포하는 데 이러한 구현 수준의 차이점을 반드시 이해할 필요는 없습니다.

![볼륨이란?](media/plan-volumes/what-are-volumes.png)

모든 볼륨은 클러스터에 있는 모든 서버에서 동시에 액세스할 수 있습니다. 만든 후에는 모든 서버의 **C:\clusterstorage\\** 에 표시 됩니다.

![csv-폴더-스크린샷](media/plan-volumes/csv-folder-screenshot.png)

## <a name="choosing-how-many-volumes-to-create"></a>만들려는 볼륨의 수 선택

볼륨의 수를 클러스터에 있는 서버 수의 배수로 만드는 것이 좋습니다. 예를 들어 서버가 4 개 있는 경우 3 또는 5 개 보다 4 개의 총 볼륨을 통해 보다 일관 된 성능을 경험할 수 있습니다. 이를 통해 클러스터는 서버 간에 볼륨 "소유권"(각 볼륨에 대해 하나의 서버가 메타 데이터 오케스트레이션을 처리함)을 고르게 배포할 수 있습니다.

볼륨의 총 수를 다음으로 제한 하는 것이 좋습니다.

| Windows Server 2016          | Windows Server 2019          |
|------------------------------|------------------------------|
| 클러스터 당 최대 32 볼륨 | 클러스터 당 최대 64 볼륨 |

## <a name="choosing-the-filesystem"></a>파일 시스템 선택

저장소 공간 다이렉트에 새로운 [ReFS(복원 파일 시스템)](../refs/refs-overview.md)을 사용하는 것이 좋습니다. ReFS는 가상화를 위해 구축된 뛰어난 파일 시스템으로, 인상적인 성능 가속화 및 데이터 손상에 대한 기본 보호 기능을 제공합니다. Windows Server 버전 1709 이상에서 데이터 중복 제거를 포함 하 여 거의 모든 키 NTFS 기능을 지원 합니다. 자세한 내용은 ReFS [기능 비교 표](../refs/refs-overview.md#feature-comparison) 를 참조 하세요.

ReFS가 아직 지원하지 않는 기능이 작업에 필요한 경우 대신 NTFS를 사용할 수 있습니다.

   > [!TIP]
   > 서로 다른 파일 시스템을 가진 볼륨이 동일한 클러스터에 공존할 수 있습니다.

## <a name="choosing-the-resiliency-type"></a>복원력 유형 선택

저장소 공간 다이렉트에서 볼륨은 복원력을 제공하여 드라이브 또는 서버 오류와 같은 하드웨어 문제로부터 보호하고 소프트웨어 업데이트와 같은 서버 유지 관리 전반에 걸쳐 가용성을 지속적으로 유지할 수 있게 합니다.

   > [!NOTE]
   > 선택할 수 있는 복원력 유형은 사용자가 보유한 드라이브 유형과 별개입니다.

### <a name="with-two-servers"></a>서버 두 개가 있는 경우

클러스터에 두 개의 서버가 있으면 양방향 미러링을 사용할 수 있습니다. Windows Server 2019를 실행 하는 경우 중첩 된 복원 력을 사용할 수도 있습니다.

양방향 미러링은 모든 데이터의 복사본 두 개를 각 서버에 있는 드라이브에 하나씩 보관 합니다. 저장소 효율성은 50% 이며 1TB의 데이터를 쓰려면 저장소 풀에서 2tb 이상의 실제 저장소 용량이 필요 합니다. 양방향 미러링은 한 번에 하나의 하드웨어 오류를 안전 하 게 허용할 수 있습니다 (하나의 서버 또는 드라이브).

![양방향 미러](media/plan-volumes/two-way-mirror.png)

중첩 된 복원 력 (Windows Server 2019 에서만 사용 가능)은 양방향 미러링을 사용 하는 서버 간에 데이터 복원 력을 제공 하 고 양방향 미러링 또는 미러 가속 패리티를 사용 하 여 서버 내에 복원 력을 추가 합니다. 중첩은 한 서버를 다시 시작 하거나 사용할 수 없는 경우에도 데이터 복원 력을 제공 합니다. 중첩 된 미러링 가속화 된 패리티의 경우 35-40%의 중첩 된 양방향 미러링의 저장소 효율성이 25%입니다. 중첩 된 복원 력은 한 번에 두 개의 하드웨어 오류를 안전 하 게 허용할 수 있습니다 (두 개의 드라이브 또는 서버와 나머지 서버에서 드라이브). 이러한 데이터 복원 력이 추가 되었기 때문에 Windows Server 2019를 실행 하는 경우 두 서버 클러스터의 프로덕션 배포에 중첩 된 복원 력을 사용 하는 것이 좋습니다. 자세한 내용은 [중첩 된 복원 력](nested-resiliency.md)을 참조 하세요.

![중첩 된 미러 가속 패리티](media/nested-resiliency/nested-mirror-accelerated-parity.png)

### <a name="with-three-servers"></a>서버 세 개가 있는 경우

서버 세 개가 있는 경우 더 나은 내결함성과 성능을 위해 3방향 미러링을 사용해야 합니다. 3방향 미러링은 모든 데이터의 복사본 세 개를 각 서버에 있는 드라이브에 하나씩 유지합니다. 저장소 효율성은 33.3%입니다. 즉, 1TB의 데이터를 기록하려면 저장소 풀에 최소 3TB의 물리적 저장소 용량이 필요합니다. 3방향 미러링은 [한 번에 두 개 이상 하드웨어 문제(드라이브 또는 서버)](storage-spaces-fault-tolerance.md#examples)를 안전하게 허용할 수 있습니다. 2 개의 노드를 사용할 수 없는 경우 2/3 디스크를 사용할 수 없으므로 저장소 풀에서 쿼럼이 손실 되 고 가상 디스크가 액세스할 수 없습니다 됩니다. 그러나 노드가 다운 되 고 하나 이상의 디스크가 다른 노드에 실패할 수 있으며 가상 디스크는 온라인 상태로 유지 됩니다. 예를 들어 갑자기 또 다른 드라이브나 서버에 장애가 발생할 때 서버 하나를 재부팅하는 경우 모든 데이터가 안전하고 지속적으로 액세스할 수 있는 상태로 유지됩니다.

![3방향 미러](media/plan-volumes/three-way-mirror.png)

### <a name="with-four-or-more-servers"></a>네 개 이상의 서버가 있는 경우

서버를 4 개 이상 사용 하는 경우 각 볼륨에 대해 3 방향 미러링과 이중 패리티 ("지우기 코딩"이 라고도 함)를 사용할지 아니면 미러 가속 패리티를 혼합 하 여 선택할 수 있습니다.

이중 패리티는 3방향 미러링과 동일한 내결함성을 제공하지만 저장소 효율성은 더 높습니다. 4 대의 서버에서 저장소 효율성이 50.0% — 2tb의 데이터를 저장 하려면 저장소 풀에서 2tb의 물리적 저장소 용량이 필요 합니다. 7개의 서버를 통해 저장소 효율성을 66.7%로 높이고 최대 80.0%의 저장소 효율성을 유지합니다. 패리티 인코딩은 계산을 많이 사용하기 때문에 성능이 제한될 수 있습니다.

![이중 패리티](media/plan-volumes/dual-parity.png)

어떤 복원력 유형을 사용할 것인지 여부는 작업의 요구 사항에 따라 다릅니다. 각 복원 력 유형에 적합 한 워크 로드 및 각 복원 력 유형의 성능 및 저장소 효율성을 요약 하는 표는 다음과 같습니다.

| 복원 유형 | 용량 효율성 | 속도 | 작업 |
| ------------------- | ----------------------  | --------- | ------------- |
| **미러**         | ![33%를 표시 하는 저장소 효율성](media/plan-volumes/3-way-mirror-storage-efficiency.png)<br>3 방향 미러: 33% <br>양방향 미러: 50%     |![100%를 보여 주는 성능](media/plan-volumes/three-way-mirror-perf.png)<br> 최고 성능  | 가상화 된 워크 로드<br> 데이터베이스<br>기타 고성능 워크 로드 |
| **미러 가속 패리티** |![50%를 보여 주는 저장소 효율성](media/plan-volumes/mirror-accelerated-parity-storage-efficiency.png)<br> 미러 및 패리티의 비율에 따라 달라 집니다. | ![20% 주위에 표시 되는 성능](media/plan-volumes/mirror-accelerated-parity-perf.png)<br>미러 속도 보다 훨씬 느리지만 이중 패리티와 최대 2 배<br> 대량 순차 쓰기 및 읽기에 적합 | 보관 및 백업<br> 가상화 된 데스크톱 인프라     |
| **이중 패리티**               | ![80%를 보여 주는 저장소 효율성](media/plan-volumes/dual-parity-storage-efficiency.png)<br>4 서버: 50% <br>16 대의 서버: 최대 80% | ![약 10%를 표시 하는 성능](media/plan-volumes/dual-parity-perf.png)<br>쓰기에 대 한 CPU 사용량 & 최고 i/o 대기 시간<br> 대량 순차 쓰기 및 읽기에 적합 | 보관 및 백업<br> 가상화 된 데스크톱 인프라  |

#### <a name="when-performance-matters-most"></a>성능이 가장 중요한 요소인 경우

엄격한 대기 시간 요구 사항이 있는 작업이거나 SQL Server 데이터베이스 또는 성능이 중요한 Hyper-V 가상 컴퓨터 같이 혼합된 임의 IOPS가 많이 필요한 작업은 미러링을 사용하여 성능을 극대화하는 볼륨에서 실행해야 합니다.

   >[!TIP]
   > 미러링은 다른 어떠한 복원력 유형보다도 속도가 빠릅니다. 성능을 보여 주는 거의 모든 작업에 미러링을 사용합니다.

#### <a name="when-capacity-matters-most"></a>용량이 가장 중요한 요소인 경우

데이터 웨어하우스 또는 '콜드' 저장소와 같이 자주 기록하지 않는 작업은 이중 패리티를 사용하여 저장소 효율성을 극대화하는 볼륨에서 실행해야 합니다. 기존의 파일 서버, VDI(가상 데스크톱 인프라) 같은 다른 특정 작업 또는 빠른 속도의 임의 I/O 트래픽을 많이 생성하지 않고 최고의 성능을 요구하지 않는 다른 작업에서도 재량에 따라 이중 패리티를 사용할 수 있습니다. 패리티는 미러링과 비교할 때 특히 쓰기에서 CPU 사용률 및 IO 대기 시간을 불가피하게 높입니다.

#### <a name="when-data-is-written-in-bulk"></a>데이터를 대량으로 기록하는 경우

보관 또는 백업 대상과 같이 순차적으로 대량 기록되는 작업에는 하나의 볼륨이 미러링과 이중 패리티를 혼합할 수 있는 Windows Server 2016의 새로운 옵션이 적용될 수 있습니다. 미러링된 부분에 먼저 쓰기가 표시된 다음 패리티 부분으로 점차 이동합니다. 이렇게 하면 계산을 많이 사용하는 패리티 인코딩이 더 오랜 시간 동안 발생하게 함으로써 많은 양의 쓰기가 도착할 때 수집이 가속화되고 리소스 사용률이 감소합니다. 일부 크기를 조정할 때 한 번에 발생하는 쓰기 양(일별 백업 등)이 미러링 부분에 적절히 부합해야 한다는 것을 고려해 보세요. 예를 들어 매일 100GB를 수집하는 경우 150GB~200GB는 미러링을 사용하고 나머지는 이중 패리티를 사용하는 것을 고려해 보세요.

결과로 나타나는 저장소 효율성은 선택한 비율에 따라 달라집니다. [이 데모](https://www.youtube.com/watch?v=-LK2ViRGbWs&t=36m55s)에서 몇 가지 예를 참조하세요.

   > [!TIP]
   > 데이터 수집을 통해 쓰기 성능 걸리거나 급격 한 감소를 관찰 하는 경우 미러 부분이 충분히 크지 않거나 사용자의 사용 사례에 대해 미러 가속 패리티가 적합 하지 않다는 것을 나타낼 수 있습니다. 예를 들어 쓰기 성능이 400 m b/초에서 40 m b/초로 감소 하는 경우 미러 부분을 확장 하거나 3 방향 미러로 전환 하는 것이 좋습니다.

### <a name="about-deployments-with-nvme-ssd-and-hdd"></a>NVMe, SSD, 및 HDD 배포 정보

두 가지 유형의 드라이브를 사용하는 배포에서 빠른 드라이브는 캐싱을 제공하고 느린 드라이브는 용량을 제공합니다. 이 작업은 자동으로 수행됩니다. 자세한 내용은 [저장소 공간 다이렉트에서 캐시 이해](understand-the-cache.md)를 참조하세요. 이러한 배포에서 모든 볼륨은 결국 같은 유형의 드라이브인 용량 드라이브에 상주합니다.

세 가지 유형의 드라이브를 모두 사용하는 배포에서 가장 빠른 드라이브(NVMe)만 캐싱을 제공하고 나머지 두 가지 유형의 드라이브(SSD 및 HDD)는 용량을 제공합니다. 각 볼륨에 대해 SSD 계층에 전체적으로 상주할지, HDD 계층에 전체적으로 상주할지 또는 두 계층에 걸쳐 상주할지 여부를 선택할 수 있습니다.

   > [!IMPORTANT]
   > 성능이 가장 중요한 작업을 SSD 계층을 사용하여 플래시 전용에 배치하는 것이 좋습니다.

## <a name="choosing-the-size-of-volumes"></a>볼륨의 크기 선택

각 볼륨의 크기를 다음으로 제한 하는 것이 좋습니다.

| Windows Server 2016 | Windows Server 2019 |
| ------------------- | ------------------- |
| 최대 32 TB         | 최대 64 TB         |

   > [!TIP]
   > 파일 서버 작업에 일반적으로 사용 되는 VSS (볼륨 섀도 복사본 서비스) 및 Volsnap 소프트웨어 공급자를 사용 하는 백업 솔루션을 사용 하는 경우, 볼륨 크기를 10TB로 제한 하면 성능과 안정성이 향상 됩니다. 최신 Hyper-V RCT API 및/또는 ReFS 블록 복제 및/또는 기본 SQL 백업 API를 사용하는 백업 솔루션은 최대 32TB 이상까지 제대로 작동합니다.

### <a name="footprint"></a>사용 공간

볼륨의 크기는 사용 가능한 용량, 저장할 수 있는 데이터의 양을 의미합니다. **New-Volume** cmdlet의 **-Size**  매개 변수를 통해 제공되며 **Get-Volume** cmdlet을 실행할 때 **Size** 속성에 표시됩니다.

크기는 저장소 풀을 차지하는 전체 물리적 저장소 용량인 볼륨의 *사용 공간*과는 다릅니다. 사용 공간은 해당 복원력 유형에 따라 달라집니다. 예를 들어, 3방향 미러링을 사용하는 볼륨은 크기보다 세 배가 큰 사용 공간을 가집니다.

볼륨의 사용 공간은 저장소 풀에 잘 맞아야 합니다.

![크기와 사용 공간](media/plan-volumes/size-versus-footprint.png)

### <a name="reserve-capacity"></a>예약 용량

할당되지 않은 저장소 풀에 일부 용량을 남겨 두면 드라이브에 장애가 발생한 후에도 볼륨이 "바로" 복구할 수 있게 하므로 데이터 안전성과 성능이 향상됩니다. 용량이 부족한 경우 병렬 복구는 장애가 발생한 드라이브가 교체되기 전에도 현재 위치에서 즉각적으로 볼륨을 완전한 복원력으로 복원할 수 있습니다. 이 작업은 자동으로 수행됩니다.

서버당 하나의 용량 드라이브씩 최대 4개의 드라이브를 예약하는 것이 좋습니다. 사용자의 재량에 따라 더 예약할 수 있습니다. 하지만 이 최소 권장 사항은 드라이브의 장애 발생 이후 현재 위치의 즉각적인 병렬 복구를 보장합니다.

![reserve](media/plan-volumes/reserve.png)

예를 들어 서버가 두 개 있고 1TB 용량 드라이브를 사용하는 경우 풀에서 2 x 1 = 2TB를 예약합니다. 서버가 세 개 있고 1TB 용량 드라이브를 사용하는 경우 3 x 1 = 3TB를 예약합니다. 서버가 네 개 있고 1TB 용량 드라이브를 사용하는 경우 4 x 1 = 4TB를 예약합니다.

   >[!NOTE]
   > 세 가지 유형의 드라이브(NVMe+SSD+HDD)를 모두 갖춘 클러스터에서는 서버당 하나의 SSD 및 HDD씩 최대 4개의 드라이브를 예약하는 것이 좋습니다.

## <a name="example-capacity-planning"></a>예: 용량 계획

하나의 클러스터에 네 개의 서버를 고려해 보세요. 각 서버에는 용량에 몇 가지 캐시 드라이브 및 16개의 2TB 드라이브가 있습니다.

```
4 servers x 16 drives each x 2 TB each = 128 TB
```

이 128TB의 저장소 풀에서는 드라이브에 장애가 발생한 후 교체할 필요 없이 바로 복구 작업이 수행될 수 있도록 4개의 드라이브(8TB)를 예약합니다. 이렇게 하면 볼륨을 만들 수 있는 풀에 120TB의 물리적 저장소 용량이 남습니다.

```
128 TB – (4 x 2 TB) = 120 TB
```

배포를 통해 일부 활성 Hyper-V 가상 컴퓨터를 호스팅해야 하지만, 보존해야 할 오래된 파일과 백업이 있는 콜드 저장소도 많이 있다고 가정해 보겠습니다. 네 개의 서버를 가지고 있으므로 네 개의 볼륨을 만들겠습니다.

처음 두 개의 볼륨 *Volume1* 및 *Volume2*에 가상 컴퓨터를 저장합니다. (빠른 생성 및 검사점을 위해) 파일 시스템으로 ReFS를 선택하고 복원력을 위해 3방향 미러링을 선택하여 성능을 극대화합니다. 다른 두 개의 볼륨 *Volume 3* 및 *Volume 4*에 콜드 저장소를 저장합니다. (데이터 중복 제거를 위해) 파일 시스템으로 NTFS를 선택하고 복원력을 위해 이중 패리티를 선택하여 성능을 극대화합니다.

모든 볼륨을 동일한 크기로 만들 필요는 없지만 편의상의 예를 들어 모두 12TB로 만들 수 있습니다.

*Volume1* 및 *Volume2*는 각각 12TB x 33.3% = 36TB의 물리적 저장소 용량을 차지합니다.

*Volume3* 및 *Volume4*는 각각 12TB x 50.0% = 24TB의 물리적 저장소 용량을 차지합니다.

```
36 TB + 36 TB + 24 TB + 24 TB = 120 TB
```

네 개의 볼륨은 풀에서 사용할 수 있는 물리적 저장소 용량과 정확하게 일치합니다. 좋습니다!

![예](media/plan-volumes/example.png)

   >[!TIP]
   > 모든 볼륨을 즉시 만들 필요는 없습니다. 언제든 볼륨을 확장하거나 나중에 새로운 볼륨을 만들 수 있습니다.

편의상 이 예제에서는 1TB = 1,000,000,000,000바이트의 의미로 10진수(밑10)를 사용합니다. 그러나 Windows의 저장 용량은 2진수(밑 2)로 표시됩니다. 예를 들어 2TB 드라이브는 Windows에서 각각 1.82TiB로 표시됩니다. 마찬가지로, 128TB 저장소 풀은 116.41TiB로 표시됩니다. 이는 예정된 동작입니다.

## <a name="usage"></a>사용법

[저장소 공간 다이렉트에서 볼륨 만들기](create-volumes.md)를 참조하세요.

### <a name="see-also"></a>참고 항목

- [스토리지 공간 다이렉트 개요](storage-spaces-direct-overview.md)
- [스토리지 공간 다이렉트 드라이브 선택](choosing-drives.md)
- [내결함성 및 스토리지 효율성](storage-spaces-fault-tolerance.md)
