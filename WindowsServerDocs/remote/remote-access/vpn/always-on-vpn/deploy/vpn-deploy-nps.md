---
title: NPS 서버 설치 및 구성
description: VPN 서버에서 전송 되는 연결 요청을 NPS 서버 처리 사용자 권한이 사용자의 id에 연결 하려면 NPS에서 RADIUS 계정을 구성할 때 선택한 연결 요청의 측면 기록 되었는지 확인 합니다.
ms.prod: windows-server-threshold
ms.technology: networking-ras
ms.topic: article
ms.assetid: ''
ms.localizationpriority: medium
ms.author: pashort
author: shortpatti
ms.date: 08/30/2018
ms.openlocfilehash: ca52aeeed8c4872e4d9a433c55bddc65a74d9dc0
ms.sourcegitcommit: 0948a1abff1c1be506216eeb51ffc6f752a9fe7e
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 06/06/2019
ms.locfileid: "66749614"
---
# <a name="step-4-install-and-configure-the-network-policy-server-nps"></a>4단계. 설치 및 구성 (NPS (네트워크 정책 서버)

> 적용 대상: Windows Server 2019, Windows Server (반기 채널), Windows Server 2016, Windows Server 2012 R2, Windows 10

- [**다음:** 3단계. Always On VPN에 대한 원격 액세스 서버 구성](vpn-deploy-ras.md)
- [**다음:** 5단계. DNS 및 방화벽 설정 구성](vpn-deploy-dns-firewall.md)

이 단계에서는 VPN 서버에서 전송 되는 연결 요청 처리를 위한 네트워크 정책 (NPS 서버) 설치:

- 사용자에 연결할 수 있는 권한이 있는지 확인 하려면 권한 부여를 수행 합니다.
- 사용자의 id를 확인 하는 인증을 수행 합니다.
- NPS에서 RADIUS 계정을 구성할 때 선택한 연결 요청의 측면을 기록 하는 계정을 수행 합니다.

이 섹션의 단계를 사용 하면 다음 항목을 완료 하려면:

1. NPS 서버에 대해 계획 하 고 조직 또는 회사 네트워크에 설치 된 VM 또는 컴퓨터에서 NPS를 설치할 수 있습니다.

   >[!TIP]
   >네트워크에 하나 이상의 NPS 서버가 이미 있는 경우에 NPS 서버 설치를 수행할 필요가 없습니다-기존 NPS 서버의 구성을 업데이트 하려면이 항목 대신 사용할 수 있습니다.

> [!NOTE]
> Windows Server Core에서 네트워크 정책 서버 서비스를 설치할 수 없습니다.

2. 조직/회사 NPS 서버에서 VPN 서버에서 받은 연결 요청을 처리 하는 RADIUS 서버로 수행 하는 NPS를 구성할 수 있습니다.

## <a name="install-network-policy-server"></a>NPS(네트워크 정책 서버) 설치

이 절차에서는 Windows PowerShell 또는 서버 관리자 추가 역할 및 기능 마법사 중 하나를 사용 하 여 NPS를 설치 합니다. NPS는 네트워크 정책 및 액세스 서비스 서버 역할의 역할 서비스입니다.

>[!TIP]
>기본적으로 NPS는 설치된 모든 네트워크 어댑터의 포트 1812, 1813, 1645 및 1646에서 RADIUS 트래픽을 수신 대기합니다. NPS를 설치할 때 고급 보안이 포함 된 Windows 방화벽을 사용 하도록 설정 하면 IPv4 및 IPv6 모두 트래픽에 대 한 이러한 포트에 대 한 방화벽 예외 자동으로 생성 합니다. 네트워크 액세스 서버가 이러한 기본값 이외의 포트를 통해 RADIUS 트래픽을 보내도록 구성 된 경우 NPS 설치 중 Windows Firewall with Advanced Security에서에서 생성 된 예외를 제거 하 고 예외를 사용 하 여는 포트를 만들려면 RADIUS 트래픽을 합니다.

**Windows PowerShell에 대 한 절차:**

Windows PowerShell을 사용 하 여이 절차를 수행 하 고, 관리자 권한으로 Windows PowerShell을 실행 하 고, 다음 cmdlet을 입력 합니다.

```powershell
Install-WindowsFeature NPAS -IncludeManagementTools
```

**서버 관리자에 대 한 절차:**

1.  서버 관리자에서 선택 **관리**을 선택한 후 **역할 및 기능 추가**합니다.
        역할 및 기능 추가 마법사가 열립니다.

2.  시작 하기 전에, 선택 **다음**합니다.

    >[!NOTE] 
    >합니다 **시작 하기 전에** 이전에 선택한 경우에 추가 역할 및 기능 마법사의 페이지 표시 되지 않습니다 **기본적으로이 페이지 건너뛰기** 추가 역할 및 기능 마법사를 실행 하는 경우.

3.  설치 유형 선택에서 했는지 **역할 기반 또는 기능 기반 설치** 선택한 선택 **다음**합니다.

4.  선택 대상 서버에 있는지를 확인 **서버 풀에서 서버 선택** 을 선택 합니다.

5.  서버 풀에서 로컬 컴퓨터 선택 되며 선택 인지를 확인 **다음**합니다.

6.  서버 역할 선택 **역할**를 선택 **네트워크 정책 및 액세스 서비스**합니다. 네트워크 정책 및 액세스 서비스에 필요한 기능을 추가 해야 하는 경우 묻는 대화 상자가 열립니다.

7.  선택 **기능 추가**를 선택 하 고 **다음**

8.  기능 선택에서 선택 **다음**, 네트워크 정책 및 액세스 서비스에서 제공 된 정보를 검토 하 고 선택 **다음**합니다.

9.  역할 선택 서비스에서 선택 **네트워크 정책 서버**합니다.

10. 네트워크 정책 서버에 필요한 기능 선택 **기능 추가**을 선택한 후 **다음**합니다.

11. 설치 선택 확인에서에서 선택 **필요한 경우 자동으로 대상 서버를 다시 시작**합니다.

12. 선택 **Yes** 선택한를 확인 한 다음 선택 **설치**합니다.
    
    설치 진행률 페이지는 설치 프로세스 중 상태를 표시합니다. 프로세스가 완료 되 면 메시지 "에서 설치가 완료 되었습니다 *ComputerName*" 표시 됩니다. 여기서 *ComputerName* 네트워크 정책 서버를 설치 하는 컴퓨터의 이름입니다.

13. **닫기**를 선택합니다.

## <a name="configure-nps"></a>NPS 구성

모든 인증, 권한 부여를 처리 하는 NPS 구성 NPS를 설치 하 고 연결에 대 한 회계 업무를 요청 하 고 후 VPN 서버에서 수신 합니다.

### <a name="register-the-nps-server-in-active-directory"></a>Active Directory에서 NPS 서버 등록

이 절차에서는 서버를 등록 하기 Active Directory에서 연결 요청을 처리 하는 동안 사용자 계정 정보에 액세스할 수 있는 권한을 갖도록 합니다.

**절차:**

1.  서버 관리자에서 선택 **도구**를 선택한 후 **네트워크 정책 서버**합니다. NPS 콘솔이 열립니다.

2.  NPS 콘솔에서 마우스 오른쪽 단추로 클릭 **NPS (로컬)** 을 선택한 후 **Active Directory에 서버 등록**합니다.
   
     네트워크 정책 서버 대화 상자가 열립니다.

3.  네트워크 정책 서버 대화 상자에서 선택 **확인** 두 번입니다.

NPS를 등록 하는 대체 메서드를 참조 하세요 [Active Directory 도메인에서 NPS 서버를 등록](../../../../../networking/technologies/nps/nps-manage-register.md)합니다.

### <a name="configure-network-policy-server-accounting"></a>네트워크 정책 서버 계정 구성

이 절차에서는 네트워크 정책 서버 계정과 다음 로깅 유형 중 하나를 사용 하 여를 구성 합니다.

- **이벤트 로깅**합니다. 감사 및 문제해결 연결 시도에 주로 사용 합니다. NPS 콘솔에서 NPS 서버 속성을 확보 하 여 로깅 NPS 이벤트를 구성할 수 있습니다.

- **로컬 파일에 사용자 인증 및 계정 요청 로깅**합니다. 연결 분석을 위해 주로 사용 및 청구 목적으로 합니다. 공격 후 악의적인 사용자의 활동을 추적 하는 메서드를 사용 하 여 제공 하기 때문에 보안 조사 도구로 사용 합니다. 계정 구성 마법사를 사용 하 여 로컬 파일 로깅을 구성할 수 있습니다.

- **Microsoft SQL Server XML 규격 데이터베이스에 사용자 인증 및 계정 요청 로깅**합니다. 하나의 데이터 원본이 NPS를 실행 하는 여러 서버를 허용 하는 데 사용 합니다. 관계형 데이터베이스 사용의 이점을 제공 합니다. 계정 구성 마법사를 사용 하 여 SQL Server 로깅을 구성할 수 있습니다.

네트워크 정책 서버 계정에서 구성 참조 [네트워크 정책 서버 계정 구성](../../../../../networking/technologies/nps/nps-accounting-configure.md)합니다.

### <a name="add-the-vpn-server-as-a-radius-client"></a>VPN 서버를 RADIUS 클라이언트로 추가

에 [Always On VPN에 대 한 원격 액세스 서버를 구성](vpn-deploy-ras.md) 섹션에서는 설치 하 고 VPN 서버를 구성 합니다. VPN 서버 구성 하는 동안 VPN 서버에서 RADIUS 공유 암호를 추가 합니다.

이 절차를 사용 하 여 동일한 공유 암호 텍스트 문자열로 NPS에서 RADIUS 클라이언트로 VPN 서버를 구성 합니다. VPN 서버와 NPS 서버 간의 통신은 실패 또는 VPN 서버에서 사용 하는 동일한 텍스트 문자열로 사용 합니다.

>[!IMPORTANT] 
>네트워크에 새 네트워크 액세스 서버 (VPN 서버, 무선 액세스 지점, 인증 스위치 또는 전화 접속 서버)를 추가 하면 NPS는 인식 하 고 네트워크 액세스 서버와 통신할 수 있도록 서버 NPS에서 RADIUS 클라이언트로 추가 해야 합니다.

**절차:**

1. NPS 콘솔에서 NPS 서버에서 두 번 클릭 **RADIUS 클라이언트 및 서버**합니다.

2. 마우스 오른쪽 단추로 클릭 **RADIUS 클라이언트** 선택한 **새로 만들기**합니다. 새 RADIUS 클라이언트 대화 상자가 열립니다.

3. 있는지 확인 합니다 **이 RADIUS 클라이언트를 사용 하도록 설정** 확인란을 선택 합니다.

4. **이름을**를 VPN 서버에 대 한 표시 이름을 입력 합니다.

5. **주소 (IP 또는 DNS)** , NAS IP 주소 또는 FQDN을 입력 합니다.
     
     FQDN을 입력 하면 선택할 **확인** 이름을 올바르고 유효한 IP 주소로 매핑합니다 있는지를 확인 하려는 경우.

6. **공유 비밀**를 수행 합니다.

    1. 했는지 **수동** 을 선택 합니다.

    2. VPN 서버에도 입력 되는 강력한 텍스트 문자열을 입력 합니다.

    3. 공유 비밀 확인에서에서 공유 암호를 다시 입력 합니다.

7. **확인**을 선택합니다. VPN 서버는 NPS 서버에 구성 RADIUS 클라이언트의 목록에 나타납니다.

## <a name="configure-nps-as-a-radius-for-vpn-connections"></a>VPN 연결에 대 한 NPS를 radius 구성

이 절차에서는 조직 네트워크의 RADIUS 서버로 NPS를 구성 합니다. -VPN 서버를 통해 조직/회사 네트워크에 액세스 하도록 특정 그룹의 사용자만을 허용 하는 정책을 정의 해야 합니다는 NPS에서 차례로 PEAP 인증 요청에 유효한 사용자 인증서를 사용 하는 경우에 합니다.

**절차:**

1. NPS 콘솔 표준 구성에서 했는지 **전화 접속 또는 VPN 연결용 RADIUS 서버** 선택 합니다.

2. 선택 **VPN 또는 전화 접속 구성**합니다.
        
    전화 접속 또는 VPN 구성 마법사가 열립니다.

3. 선택 **가상 개인 네트워크 (VPN) 연결**, 선택한 **다음**합니다.

4. 지정 전화 접속 또는 VPN 서버에서 RADIUS 클라이언트에서 이전 단계에서 추가한 VPN 서버의 이름을 선택 합니다. VPN 서버 NetBIOS 이름을 RAS1 인 경우 선택 하는 예를 들어 **RAS1**합니다.

5. **다음**을 선택합니다.

6. 인증 방법 구성에서 다음 단계를 수행 합니다.

    1. 선택을 취소 합니다 **Microsoft 암호화 인증 버전 2 (MS-CHAPv2)** 확인란 합니다.

    2. 선택 된 **Extensible Authentication Protocol** 확인란을 선택 합니다.

    3. 유형 (액세스 및 네트워크 구성 방법에 따라)에서 **Microsoft: 보호 된 EAP (PEAP)** 을 선택한 후 **구성**합니다.
      
        보호 된 EAP 속성 편집 대화 상자가 열립니다.

    4. 선택 **제거** 보안 암호 (EAP-MSCHAP v2) EAP 종류를 제거 합니다.

    5. **추가**를 선택합니다. EAP 추가 대화 상자가 열립니다.

    6. 선택 **스마트 카드 또는 기타 인증서**을 선택한 후 **확인**합니다.

    7. 선택 **확인** 를 보호 된 EAP 속성 편집을 닫습니다.

7. **다음**을 선택합니다.

8. 사용자 지정 그룹에서 다음 단계를 수행 합니다.

    1. **추가**를 선택합니다. 사용자, 컴퓨터, 서비스 계정 또는 그룹 선택 대화 상자가 열립니다.

    2. 입력 **VPN 사용자**을 선택한 후 **확인**합니다.

    3. **다음**을 선택합니다.

9. IP 필터 지정에서 선택 **다음**합니다.

10. 암호화 설정 지정에서 선택 **다음**합니다. 변경 하지 마십시오.

    이러한 설정은이 시나리오를 지원 하지 않는 MPPE Microsoft 지점 간 암호화 () 연결에만 적용 됩니다.

11. 영역 이름 지정 선택 **다음**합니다.

12. 선택 **완료** 마법사를 닫습니다.

## <a name="autoenroll-the-nps-server-certificate"></a>NPS 서버 인증서 자동 등록

이 절차에서는 수동으로 새로 고칠 있습니다 그룹 정책 로컬 NPS 서버에 있습니다. 경우 그룹 정책 새로 고침, 인증서 자동 등록 구성 되어 있고 제대로 작동 로컬 컴퓨터의 경우 자동 등록 된 인증서를 인증 기관 (CA)에서.

>[!NOTE]  
>그룹 정책은 자동으로 새로 고쳐지지는 사용자가 도메인 구성원 컴퓨터에 로그온 할 때 또는 도메인 구성원 컴퓨터를 다시 시작 합니다. 또한 그룹 정책 정기적으로 새로 고칩니다. 기본적으로이 정기적 새로 고침에는 기본적으로 최대 30 분의 임의 오프셋 90 분 마다 발생합니다.

멤버 자격이 **관리자**, 또는 이와 동등한 최소한이이 절차를 완료 합니다.

**절차:**

1. NPS를 Windows PowerShell을 엽니다.

2. Windows PowerShell 프롬프트에서 입력 **gpupdate**, 한 다음 ENTER를 누릅니다.

## <a name="next-steps"></a>다음 단계

[5단계. Always On VPN에 대 한 DNS 및 방화벽 설정 구성](vpn-deploy-dns-firewall.md): 이 단계에서는 Windows PowerShell 또는 서버 관리자 추가 역할 및 기능 마법사 중 하나를 사용 하 여 네트워크 정책 (NPS 서버)를 설치 합니다. 모든 인증, 권한 부여 및 연결에 대 한 회계 업무를 처리 하는 NPS를 구성할 수도 있습니다는 VPN 서버에서 수신한 요청 합니다.