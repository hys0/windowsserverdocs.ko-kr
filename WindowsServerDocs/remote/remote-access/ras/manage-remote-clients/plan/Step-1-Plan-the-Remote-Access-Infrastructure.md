---
title: 1 단계 원격 액세스 인프라 계획
description: 이 항목은 가이드 Windows Server 2016에서 원격으로 관리 DirectAccess 클라이언트의 일부입니다.
manager: brianlic
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: networking-ras
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: a1ce7af5-f3fe-4fc9-82e8-926800e37bc1
ms.author: pashort
author: shortpatti
ms.openlocfilehash: f3b1837145dee5767741052c548a4b44da56659b
ms.sourcegitcommit: be243a92f09048ca80f85d71555ea6ee3751d712
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/11/2019
ms.locfileid: "67792328"
---
# <a name="step-1-plan-the-remote-access-infrastructure"></a>1 단계 원격 액세스 인프라 계획

>적용 대상: Windows Server(반기 채널), Windows Server 2016

> [!NOTE]
> Windows Server 2016 DirectAccess 및 라우팅 및 원격 액세스 서비스 (RRAS)를 단일 원격 액세스 역할로 결합합니다.  
  
이 항목에서는 DirectAccess 클라이언트의 원격 관리를 위해 단일 원격 액세스 서버를 설정 하는 데 사용할 수 있는 인프라를 계획 하는 단계를 설명 합니다. 다음 표에서 단계를 수행 하지만 이러한 계획 작업 특정 순서에 따라 수행할 필요가 없습니다.  
  
|태스크|설명|  
|----|--------|  
|[네트워크 토폴로지 및 서버 설정 계획](#plan-network-topology-and-settings)|(에 지에서 또는 네트워크 주소 변환 (NAT) 장치 또는 방화벽 뒤에), 원격 액세스 서버를 배치 하 고 IP 주소 지정과 라우팅을 계획 결정 합니다.|  
|[방화벽 요구 사항 계획](#plan-firewall-requirements)|원격 액세스가 경계면 방화벽을 통과하도록 허용할 계획을 수립합니다.|  
|[인증서 요구 사항 계획](#plan-certificate-requirements)|클라이언트 인증, Kerberos 프로토콜 또는 인증서를 사용 하 고 웹 사이트 인증서 계획는 경우를 결정 합니다.<br/><br/>IP-HTTPS는 DirectAccess 클라이언트가 IPv4 네트워크상의 IPv6 트래픽을 터널링하는 데 사용되는 변환 프로토콜입니다. 인증 기관 (CA)에서 또는 원격 액세스 서버에서 자동으로 발급 된 자체 서명 된 인증서를 사용 하 여 발급 된 인증서를 사용 하 여 IP-HTTPS 서버의 인증 여부를 결정 합니다.|  
|[DNS 요구 사항 계획](#plan-dns-requirements)|원격 액세스 서버, 인프라 서버, 로컬 이름 확인 옵션 및 클라이언트 연결에 대 한 도메인 이름 시스템 (DNS) 설정을 계획 합니다.| 
|[네트워크 위치 서버 구성 계획](#plan-the-network-location-server-configuration)|네트워크 위치 서버 웹 사이트 (원격 액세스 서버 또는 대체 서버)에서 조직에 배치 하 고 네트워크 위치 서버가 원격 액세스 서버에 있을 경우 인증서 요구 사항 계획을 결정 합니다. **참고:** 네트워크 위치 서버는 DirectAccess 클라이언트가 내부 네트워크에 있는지 확인하는 데 사용됩니다.|  
|[관리 서버 구성 계획](#plan-management-servers-configuration)|원격 클라이언트 관리 시 사용되는 관리 서버(예: 업데이트 서버)를 계획합니다. **참고:** 관리자는 인터넷을 사용하여 회사 네트워크 외부에 있는 DirectAccess 클라이언트 컴퓨터를 원격으로 관리할 수 있습니다.|  
|[Active Directory 요구 사항 계획](#plan-active-directory-requirements)|도메인 컨트롤러, Active Directory 요구 사항, 클라이언트 인증 및 여러 도메인 구조를 계획 합니다.|  
|[그룹 정책 개체 만들기 계획](#plan-group-policy-object-creation)|Gpo는 데 필요한 항목 결정 만들고 Gpo를 편집 하는 방법을 조직에 있습니다.|  
  
## <a name="plan-network-topology-and-settings"></a>네트워크 토폴로지 및 설정 계획  
네트워크를 계획할 때 네트워크 어댑터 토폴로지, IP 주소 지정에 대 한 설정과 ISATAP에 대 한 요구 사항을 고려해 야 합니다.  
  
### <a name="plan-network-adapters-and-ip-addressing"></a>네트워크 어댑터 및 IP 주소 지정 계획  
  
1.  사용 하려는 네트워크 어댑터 토폴로지를 식별 합니다. 다음 토폴로지 중 하나를 사용 하 여 원격 액세스를 설정할 수 있습니다.  
  
    -   두 개의 네트워크 어댑터: 원격 액세스 서버는 인터넷 및 내부 네트워크에 연결 하는 하나의 네트워크 어댑터를 사용 하 여에 지에 설치 됩니다.  
  
    -   두 개의 네트워크 어댑터: 원격 액세스 서버를 NAT 장치, 방화벽 또는 라우터를 경계 네트워크 및 내부 네트워크에 연결 하는 하나의 네트워크 어댑터를 사용 하 여 설치 됩니다.  
  
    -   하나의 네트워크 어댑터: 원격 액세스 서버를 NAT 장치 뒤에 설치 하 고, 단일 네트워크 어댑터는 내부 네트워크에 연결 합니다.  
  
2.  IP 주소 지정 요구 사항을 확인합니다.  
  
    DirectAccess는 IPsec에서 IPv6을 사용하여 DirectAccess 클라이언트 컴퓨터와 회사 내부 네트워크 사이의 보안 연결을 만듭니다. 그러나 DirectAccess를 사용하기 위해 반드시 IPv6 인터넷 또는 내부 네트워크에서 지원되는 기본 IPv6에 연결할 필요는 없습니다. 대신, 자동으로 구성 하 고 IPv6 전환 기술을 사용 하 여 IPv4 인터넷 (6to4, Teredo 또는 IP-HTTPS) 및 ((nat64 또는 ISATAP) IPv4 전용 인트라넷에서 IPv6 트래픽을 터널링 합니다. 이러한 전환 기술에 대한 개요는 다음 리소스를 참조하세요.  
  
    -   [IPv6 전환 기술](https://technet.microsoft.com/library/bb726951.aspx)  
  
    -   [IP-HTTPS 터널링 프로토콜 사양](https://msdn.microsoft.com/library/dd358571.aspx)  
  
3.  다음 표에 따라 필요한 어댑터 및 주소를 구성합니다. 만 사용 하 여 IP 주소를 구성 하는 단일 네트워크 어댑터를 사용 하는 NAT 장치 뒤에 있는 배포에 대 한 합니다 **내부 네트워크 어댑터** 열입니다.  
  
    ||외부 네트워크 어댑터|내부 네트워크 어댑터<sup>1, 위</sup>|라우팅 요구 사항|  
    |-|--------------|------------------------|------------|  
    |IPv4 인터넷 및 IPv4 인트라넷|다음을 구성합니다.<br/><br/>-두 정적 (teredo에 필요) 적절 한 서브넷 마스크를 사용 하 여 연속 된 공용 IPv4 주소입니다.<br/>-기본 게이트웨이 인터넷 방화벽이 나 로컬 인터넷 서비스 공급자 (ISP) 라우터의 IPv4 주소입니다. **참고:** 원격 액세스 서버가 Teredo 서버 처럼 작동할 수 있습니다 하 고 Windows 기반 Teredo 클라이언트 원격 액세스 서버를 사용 하 여 NAT 장치 유형을 검색할 수 있도록 두 개의 공용 IPv4 주소가 필요 합니다.|다음을 구성합니다.<br/><br/>-적절 한 서브넷 마스크는 IPv4 인트라넷 주소입니다.<br/>인트라넷 네임 스페이스에 대 한-연결별 DNS 접미사입니다. DNS 서버도 내부 인터페이스에 구성해야 합니다. **주의:** 인트라넷 인터페이스에 기본 게이트웨이를 구성하지 마세요.|내부 IPv4 네트워크의 모든 서브넷에 연결할 원격 액세스 서버를 구성 하려면 다음을 수행 합니다.<br/><br/>-인트라넷의 모든 위치에 대 한 IPv4 주소 공간을 나열 합니다.<br/>-을 사용 합니다 `route add -p` 또는 `netsh interface ipv4 add route` 주소 공간을 원격 액세스 서버의 IPv4 라우팅 테이블에 고정 경로로 IPv4를 추가 하는 명령입니다.|  
    |IPv6 인터넷 및 IPv6 인트라넷|다음을 구성합니다.<br/><br/>-ISP에서 제공 하 고 자동 구성 된 주소 구성을 사용 합니다.<br/>-사용 된 `route print` ISP 라우터를 가리키는 기본 IPv6 경로가 IPv6 라우팅 테이블에 있는지 확인 하는 명령입니다.<br/>-ISP 및 인트라넷 라우터가 RFC 4191에 설명 된 대로 기본 라우터 설정을 사용 하는 경우 확인 한 경우 로컬 인트라넷 라우터 보다 높은 기본 기본 설정을 사용 합니다. 둘 다에 해당되면 기본 경로에 대한 다른 구성이 필요하지 않습니다. ISP 라우터의 우선 순위가 높으면 원격 액세스 서버의 활성 기본 IPv6 경로가 IPv6 인터넷을 가리킵니다.<br/><br/>원격 액세스 서버가 IPv6 라우터이므로 기본 IPv6 인프라가 있는 경우 인터넷 인터페이스에서 인트라넷의 도메인 컨트롤러에도 연결할 수 있습니다. 이 경우 원격 액세스 서버의 인터넷 인터페이스의 IPv6 주소에 대 한 연결을 방해 하는 경계 네트워크의 도메인 컨트롤러에 패킷 필터를 추가 합니다.|다음을 구성합니다.<br/><br/>기본 우선 수준을 사용 하지 않는 경우 사용 하 여 인트라넷 인터페이스를 구성 합니다 `netsh interface ipv6 set InterfaceIndex ignoredefaultroutes=enabled` 명령입니다. 이 명령을 사용하면 인트라넷 라우터를 가리키는 추가 기본 경로가 IPv6 라우팅 테이블에 추가되지 않습니다. 표시에서 인트라넷 인터페이스의 InterfaceIndex를 가져올 수는 `netsh interface show interface` 명령입니다.|IPv6 인트라넷을 사용하는 경우 모든 IPv6 위치에 연결하도록 원격 액세스 서버를 구성하려면 다음을 수행합니다.<br/><br/>-인트라넷의 모든 위치에 대 한 IPv6 주소 공간을 나열 합니다.<br/>-사용 된 `netsh interface ipv6 add route` 원격 액세스 서버의 IPv6 라우팅 테이블에 고정 경로로 IPv6 주소 공간을 추가 하는 명령입니다.|  
    |IPv4 인터넷 및 IPv6 인트라넷|원격 액세스 서버는 기본 IPv6 경로 트래픽을 IPv4 인터넷에 6to4 릴레이 Microsoft 6to4 어댑터 인터페이스를 사용 하 여 전달 합니다. 기본 IPv6를 회사 네트워크에 배포 되지 않은 경우 IPv4 인터넷에서 Microsoft 6to4 릴레이의 IPv4 주소에 대 한 원격 액세스 서버를 구성 하려면 다음 명령을 사용할 수 있습니다: `netsh interface ipv6 6to4 set relay name=<ipaddress> state=enabled`합니다.|||  
  
    > [!NOTE]  
    > -   DirectAccess 클라이언트에 할당 된 공용 IPv4 주소를 인트라넷에 연결할 6to4 릴레이 기술을 사용 합니다. 클라이언트 개인 IPv4 주소가 할당 되 면 Teredo를 사용 됩니다. DirectAccess 클라이언트는 6to4 또는 Teredo를 사용하여 DirectAccess 서버에 연결할 수 없는 경우 IP-HTTPS를 사용합니다.  
    > -   Teredo를 사용하려면 외부 연결 네트워크 어댑터에서 두 개의 연속된 IP 주소를 구성해야 합니다.  
    > -   원격 액세스 서버에 네트워크 어댑터가 하나뿐인 경우에 Teredo를 사용할 수 없습니다.  
    > -   기본 IPv6 클라이언트 컴퓨터는 기본 IPv6을 통해 원격 액세스 서버에 연결할 수 있으므로 전환 기술이 필요 없습니다.  
  
### <a name="plan-isatap-requirements"></a>ISATAP 요구 사항 계획  
ISATAP는 DirectAccess 관리 서버는 인터넷에 있는 DirectAccess 클라이언트에 연결할 수 있도록 DirectAccessclients의 원격 관리를 위해 필요 합니다. ISATAP는 회사 네트워크의 IPv4 리소스에 DirectAccess 클라이언트 컴퓨터에서 시작 되는 연결을 지원 하려면 필요 하지 않습니다. 이 용도에는 NAT64/DNS64가 사용됩니다. ISATAP 배포의 경우, 요구 사항을 파악 하려면 다음 표를 사용 합니다.  
  
|ISATAP 배포 시나리오|요구 사항|  
|---------------|--------|  
|(없음 ISATAP는 필요) 하는 기존 네이티브 IPv6 인트라넷|기존 기본 IPv6 인프라를 사용 하 여 원격 액세스 배포 중 조직의 접두사를 지정 하 고 원격 액세스 서버를 구성 하지 않습니다 자체적으로 ISATAP 라우터로 합니다. 다음을 수행합니다.<br/><br/>1.  DirectAccess 클라이언트는 인트라넷에서 연결할 수 있도록 원격 액세스 서버에 기본 경로 트래픽을 전달 되도록 IPv6 라우팅을 수정 해야 합니다. 인트라넷 IPv6 주소 공간 48 비트 IPv6 주소 접두사를 단일 이외의 주소를 사용 하는 경우에 배포 하는 동안 관련 조직 IPv6 접두사를 지정 해야 합니다.<br/>2.  IPv6 인터넷에 연결 하는 현재 하는 경우 원격 액세스 서버에 전달 되도록 프로그램 기본 경로 트래픽을 구성 하 고 구성한 적절 한 연결 및 경로 원격 액세스 서버에서 기본 경로 해야 합니다. IPv6 인터넷에 연결 된 장치에 트래픽을 전달 됩니다.|  
|기존 ISATAP 배포|기존 ISATAP 인프라가 경우 배포 하는 동안 메시지가 표시 되는 조직의 48 비트 접두사에 대 한 및 원격 액세스 서버를 구성 하지 않습니다 자체적으로 ISATAP 라우터로 합니다. DirectAccess 클라이언트는 인트라넷에서 연결할 수 있도록 원격 액세스 서버에 기본 경로 트래픽을 전달 되도록 IPv6 라우팅 인프라를 수정 해야 합니다. 이 변경은를 인트라넷 클라이언트 해야 이미 전달 기본 트래픽을 기존 ISATAP 라우터에서 작업을 수행 해야 합니다.|  
|기존 IPv6 연결 없음|원격 액세스 설치 마법사에서 서버 없는 네이티브 또는 ISATAP 기반 IPv6 연결 되어 있는지를 감지 하면 자동으로 인트라넷에 대 한 6to4 기반 48 비트 접두사를 파생 하 고 원격 액세스 서버 IPv6를 제공 하는 ISATAP 라우터로 구성 인트라넷에서 ISATAP 호스트에 연결 합니다. (6to4 기반 접두사는 공용 주소를가지고 하는 경우에 사용 됩니다, 그리고는 고유 로컬 주소 범위에서 자동으로 생성 하는 접두사가 고, 그렇지)<br/><br/>ISATAP를 사용 하려면 다음을 수행 합니다.<br/><br/>1.  사용 하도록 설정 하려는 연결 ISATAP 기반 ISATAP 이름은 원격 액세스 서버의 내부 IPv4 주소에 내부 DNS 서버에서 확인할 수 있도록 각 도메인에 대 한 DNS 서버에서 ISATAP 이름을 등록 합니다.<br/>2.  기본적으로 Windows Server 2012, Windows Server 2008 R2, Windows Server 2008 또는 Windows Server 2003을 실행 하는 DNS 서버는 글로벌 쿼리 차단 목록을 사용 하 여 ISATAP 이름 확인을 차단 합니다. ISATAP를 사용 하도록 설정 하면 블록 목록에서 ISATAP 이름을 제거 해야 합니다. 자세한 내용은 [DNS 글로벌 쿼리 차단 목록은에서 ISATAP 제거](https://go.microsoft.com/fwlink/p/?LinkId=168593)합니다.<br/><br/>자동으로 ISATAP 이름을 확인할 수 있는 Windows 기반 ISATAP 호스트는 다음과 같이 원격 액세스 서버를 사용 하 여 주소를 구성 합니다.<br/><br/>1.  ISATAP 터널링 인터페이스에서 ISATAP 기반 IPv6 주소<br/>2.  인트라넷의 다른 ISATAP 호스트에 연결을 제공 하는 64 비트 경로<br/>3.  원격 액세스 서버를 가리키는 기본 IPv6 경로입니다. 기본 경로 DirectAccess 클라이언트가 인트라넷의 ISATAP 호스트에 연결할 수 있는지 확인<br/><br/>Windows 기반 ISATAP 호스트는 ISATAP 기반 IPv6 주소를 얻을 때 통신 하는 경우 대상도 ISATAP 호스트에 ISATAP 캡슐화 트래픽을 사용 하기 시작 합니다. ISATAP에서는 전체 인트라넷 단일 64 비트 서브넷 때문에 통신 통신의 분할 된 IPv4 모델에서 IPv6 사용 하 여 단일 서브넷 통신 모델으로 이동 합니다. 일부 Active Directory Domain Services (AD DS)의 동작에 영향을 줄 수 있습니다 및 Active Directory 사이트 및 서비스 구성에 의존 하는 응용 프로그램입니다. 예를 들어, Active Directory 사이트를 사용 하 고 서비스 스냅인 사이트, 서브넷 IPv4 기반 및 사이트 내의 서버에 요청을 전달 하는 것에 대 한 사이트 간 전송 하도록 하는 경우이 구성은 ISATAP 호스트에서 사용 되지 않습니다.<br/><br/><ol><li>Active Directory 사이트 및 사이트 내에서 각 IPv4 서브넷 개체에 대해 ISATAP 호스트에 대 한 전달에 대 한 서비스를 구성 하는 서브넷의 IPv6 주소 접두사는 동일한 범위의 ISATAP 호스트 표현 해당 IPv6 서브넷 개체를 구성 해야 합니다. IPv4 서브넷 주소입니다. 예를 들어 IPv4에 대 한 서브넷 192.168.99.0/24 및 64 비트 ISATAP 주소 접두사 2002:836b:1:8000:: / 64의 IPv6 서브넷 개체에 대 한 해당 IPv6 주소 접두사는 2002:836b:1:8000:0:5efe:192.168.99.0/120 합니다. 임의의 IPv4 접두사 길이 (예제의 24로 설정)에 대 한 수식 96에서에서 해당 IPv6 접두사 길이 + IPv4PrefixLength를 확인할 수 있습니다.</li><li>DirectAccess 클라이언트의 IPv6 주소에 대 한 다음 추가 합니다.<br/><br/><ul><li>Teredo 기반 DirectAccess 클라이언트의 경우: 범위 2001:0:WWXX:YYZZ에 대 한 IPv6 서브넷:: / 64는 WWXX:YYZZ에서 원격 액세스 서버의 인터넷 연결 IPv4 주소의 첫 번째 콜론 16 진수 버전입니다. .</li><li>IP HTTPS 기반 DirectAccess 클라이언트의 경우: 범위 2002:WWXX:YYZZ:8100에 대 한 IPv6 서브넷::는 WWXX:YYZZ에 56은 원격 액세스 서버의 첫 번째 인터넷 연결 IPv4 주소 (w.x.y.z) 콜론 16 진수 버전입니다. .</li><li>6to4 기반 DirectAccess 클라이언트: 일련의 2002를 사용 하 여 시작 하는 6to4 기반 IPv6 접두사: 나타내고 지역별, 공용 IPv4 주소 접두사는 IANA Internet Assigned Numbers Authority () 및 레지스트리 지역에서 관리 되는 합니다. 공용 IPv4 주소 접두사 w.x.y.z/n 6to4 기반 접두사는 2002:WWXX:YYZZ:: / [16 + n], 어떤 WWXX:YYZZ w.x.y.z.의 콜론 16 진수 버전이에서<br/><br/>        예를 들어 7.0.0.0/8 범위에 대 한 인터넷 숫자 (ARIN) North America의 American 레지스트리에 의해 관리 됩니다. 이 공용 IPv6 주소 범위에 대 한 해당 6to4 기반 접두사는 2002:700:: / 24입니다. IPv4 공용 주소 공간에 대 한 정보를 참조 하세요 [IANA IPv4 주소 공간 레지스트리](https://www.iana.org/assignments/ipv4-address-space/ipv4-address-space.xml)합니다. .</li></ul></li></ol>|  
  
> [!IMPORTANT]  
> DirectAccess 서버의 내부 인터페이스에 공용 IP 주소 없는지 않습니다 확인 합니다. 내부 인터페이스에 있는 공용 ip가 ISATAP 통해 연결 실패할 수 있습니다.  
  
### <a name="plan-firewall-requirements"></a>방화벽 요구 사항 계획  
원격 액세스 서버가 경계면 방화벽 뒤에 있는 경우 원격 액세스 서버가 IPv4 인터넷에 있으면 원격 액세스 트래픽에 대한 다음과 같은 예외가 필요합니다.  
  
-   Ip-https: 전송 제어 프로토콜 (TCP) 대상 포트 443 및 TCP 포트 443 아웃 바운드 원본입니다.  
  
-   Teredo 트래픽에 대 한: 사용자 데이터 그램 프로토콜 (UDP) 대상 포트 3544 인바운드, UDP 원본 포트 3544 아웃 바운드입니다.  
  
-   6to4 트래픽에 대 한: IP 프로토콜 41 인바운드 및 아웃 바운드입니다.  
  
    > [!NOTE]  
    > Teredo 및 6to4 트래픽의 경우 이 예외는 원격 액세스 서버의 연속된 인터넷 연결 공용 IPv4 주소 둘 다에 대해 적용되어야 합니다.  
    >   
    > IP-HTTPS 용 예외 공용 DNS 서버에 등록 된 주소에 적용 해야 합니다.  
  
-   단일 네트워크 어댑터 및 네트워크 위치 서버가 원격 액세스 서버 설치를 사용 하 여 원격 액세스를 배포 하는 경우 TCP 포트 62000 합니다.  
  
    > [!NOTE]  
    > 이 예외는 원격 액세스 서버 및 경계 면 방화벽에 이전 예외.  
  
다음 예외는 원격 액세스 서버가 IPv6 인터넷에 있으면 원격 액세스 트래픽에 대해 필요 합니다.  
  
-   IP 프로토콜 50  
  
-   UDP 대상 포트 500 인바운드, UDP 원본 포트 500 아웃바운드  
  
-   ICMPv6 트래픽 인바운드 및 (만 사용 하는 경우 Teredo) 아웃 바운드입니다.  
  
추가 방화벽을 사용 하는 경우에 원격 액세스 트래픽에 대해 다음 내부 네트워크 방화벽 예외를 적용 됩니다.  
  
-   ISATAP에 대 한: 프로토콜 41 인바운드 및 아웃 바운드  
  
-   모든 IPv4/IPv6 트래픽을 처리 합니다. TCP/UD  
  
-   Teredo: ICMP - 모든 IPv4/IPv6 트래픽  
  
### <a name="plan-certificate-requirements"></a>인증서 요구 사항 계획  
단일 원격 액세스 서버를 배포할 때 인증서가 필요한 세 가지 시나리오가 있습니다.  
  
-   **IPsec 인증**: IPsec에 대 한 인증서 요구 사항에는 원격 액세스 서버를 사용 하 여 IPsec 연결을 설정할 때 DirectAccess 클라이언트 컴퓨터에서 사용 되는 컴퓨터 인증서 및 원격 액세스 서버에서 설정 하는 데 사용 되는 컴퓨터 인증서 포함 DirectAccess 클라이언트와의 IPsec 연결 합니다.  
  
    Windows Server 2012의 DirectAccess에 대해 이러한 IPsec 인증서의 사용이 필수 사항이 없습니다. 대신 원격 액세스 서버 인증서를 요구 하지 않고 Kerberos 인증에 대 한 프록시로 작동할 수 있습니다. Kerberos 인증을 사용 하는 경우 SSL을 통해 작동 하 고 Kerberos 프로토콜 IP-HTTPS에 대해 구성 된 인증서를 사용 합니다. 일부 엔터프라이즈 시나리오 (멀티 사이트 배포 및 일회용 암호 클라이언트 인증 포함)에 인증서 인증 및 Kerberos 인증이 아닌 사용을 해야 합니다.  
  
-   **IP-HTTPS 서버**: 원격 액세스를 구성한 경우 원격 액세스 서버가 IP-HTTPS 수신기 역할을 자동으로 구성 됩니다. IP-HTTPS 사이트에는 웹 사이트 인증서가 필요하므로 클라이언트 컴퓨터에서 인증서의 CRL(인증서 해지 목록) 사이트에 연결할 수 있어야 합니다.  
  
-   **네트워크 위치 서버**: 네트워크 위치 서버는 클라이언트 컴퓨터가 회사 네트워크에 있는지 검색하는 데 사용되는 웹 사이트입니다. 네트워크 위치 서버에는 웹 사이트 인증서가 필요합니다. DirectAccess 클라이언트에서 인증서의 CRL 사이트에 연결할 수 있어야 합니다.  
  
이러한 각 시나리오에 대 한 인증 기관 (CA) 요구 사항은 다음 표에 요약 되어 있습니다.  
  
|IPsec 인증|IP-HTTPS 서버|네트워크 위치 서버|  
|------------|----------|--------------|  
|내부 CA를 원격 액세스 서버 및 클라이언트에 IPsec 인증용 컴퓨터 인증서를 발급 하는 데 필요한 경우 인증에 Kerberos 프로토콜을 사용 하지 않습니다.|내부 CA: 내부 CA를 사용하여 IP-HTTPS 인증서를 발급할 수 있습니다. 그러나 CRL 배포 지점을 외부에서 사용할 수 있어야 합니다.|내부 CA: 내부 CA를 사용하여 네트워크 위치 서버 웹 사이트 인증서를 발급할 수 있습니다. 그러나 내부 네트워크에서 CRL 배포 지점을 항상 사용할 수 있어야 합니다.|  
||자체 서명된 인증서: IP-HTTPS 서버에 대 한 자체 서명 된 인증서를 사용할 수 있습니다. 멀티 사이트 배포에는 자체 서명된 인증서를 사용할 수 없습니다.|자체 서명된 인증서: 자체 서명 된 인증서를 사용 하 여 네트워크 위치 서버 웹 사이트입니다. 그러나 자체 서명 된 인증서를 멀티 사이트 배포에 사용할 수 없습니다.|  
||공용 CA: 공용 CA를 사용 하 여 IP-HTTPS 인증서를 발급 하려면, 이렇게 하면 외부에서 CRL 배포 지점을 사용할 수 있는지는 것이 좋습니다.||  
  
#### <a name="plan-computer-certificates-for-ipsec-authentication"></a>IPsec 인증용 컴퓨터 인증서 계획  
인증서 기반 IPsec 인증을 사용 하는 경우 원격 액세스 서버와 클라이언트 컴퓨터 인증서를 얻는 필요 합니다. 인증서를 설치 하는 가장 간단한 방법은 컴퓨터 인증서 자동 등록을 구성 하려면 그룹 정책을 사용 하는 것입니다. 이렇게 하면 모든 도메인 구성원이 엔터프라이즈 CA에서 인증서를 가져옵니다. 엔터프라이즈 조직에서 설정 하는 CA가 참조 [Active Directory 인증서 서비스](https://technet.microsoft.com/library/cc770357.aspx)합니다.  
  
이 인증서에는 다음과 같은 요구 사항이 있습니다.  
  
-   인증서 확장 된 키 사용 (EKU) 클라이언트 인증이 있어야 합니다.  
  
-   동일한 루트 인증서는 클라이언트와 서버 인증서 관련 되어야 합니다. DirectAccess 구성 설정에서 이 루트 인증서를 선택해야 합니다.  
  
#### <a name="plan-certificates-for-ip-https"></a>IP-HTTPS용 인증서 계획  
원격 액세스 서버가 IP-HTTPS 수신기 역할을 하므로 서버에 HTTPS 웹 사이트 인증서를 수동으로 설치해야 합니다. 계획 시 고려할 사항은 다음과 같습니다.  
  
-   CRL을 항상 사용할 수 있도록 공용 CA를 사용하는 것이 좋습니다.  
  
-   주체 필드에 원격 액세스 서버의 인터넷 어댑터 또는 IP-HTTPS URL (ConnectTo 주소)의 FQDN의 IPv4 주소를 지정 합니다. 원격 액세스 서버가 NAT 장치 뒤에 있는 경우에는 NAT 장치의 공개 이름 또는 주소를 지정해야 합니다.  
  
-   인증서의 일반 이름이 IP-HTTPS 사이트의 이름과 일치해야 합니다.  
  
-   에 대 한는 **향상 된 키 용도** 필드의 경우는 서버 인증 OID (개체 식별자)를 사용 합니다.  
  
-   **CRL 배포 지점** 필드의 경우 인터넷에 연결된 DirectAccess 클라이언트에서 액세스할 수 있는 CRL 배포 지점을 지정합니다.  
  
    > [!NOTE]  
    > 만 Windows 7을 실행 하는 클라이언트에 필요 합니다.  
  
-   IP-HTTPS 인증서에 프라이빗 키가 있어야 합니다.  
  
-   IP-HTTPS 인증서를 개인 저장소로 직접 가져와야 합니다.  
  
-   IP-HTTPS 인증서 이름에 와일드카드 문자를 사용할 수 있습니다.  
  
#### <a name="plan-website-certificates-for-the-network-location-server"></a>네트워크 위치 서버용 웹 사이트 인증서 계획  
네트워크 위치 서버 웹 사이트를 계획할 때 다음 사항을 고려 합니다.  
  
-   **주체** 필드에 네트워크 위치 서버의 인트라넷 인터페이스 IP 주소 또는 네트워크 위치 URL의 FQDN을 지정합니다.  
  
-   에 대 한 합니다 **향상 된 키 용도** 필드에 서버 인증 OID를 사용 합니다.  
  
-   에 대 한 합니다 **CRL 배포 지점** 필드, 인트라넷에 연결 된 DirectAccess 클라이언트에서 액세스할 수 있는 CRL 배포 지점을 사용 합니다. 이 CRL 배포 지점에는 내부 네트워크 외부에서 액세스할 수 없습니다.  
  
> [!NOTE]  
> IP-HTTPS 및 네트워크 위치 서버용 인증서 주체 이름이 있는지 확인 하십시오. 인증서 대체 이름에서는 원격 액세스 마법사에서 허용 되지 않습니다.  
  
#### <a name="plan-dns-requirements"></a>DNS 요구 사항 계획  
이 섹션에서는 클라이언트의 DNS 요구 사항 및 서버 원격 액세스 배포에 설명합니다.  
  
##### <a name="directaccess-client-requests"></a>DirectAccess 클라이언트 요청  
내부 네트워크에 없는 DirectAccess 클라이언트 컴퓨터의 요청을 확인하는 데 DNS가 사용됩니다. DirectAccess 클라이언트는 인터넷 또는 회사 네트워크에 배치 되는지 여부를 확인 하려면 DirectAccess 네트워크 위치 서버에 연결 하려고 합니다.  
  
-   연결이 성공 하면 클라이언트가 인트라넷에 있는 것으로 결정 됩니다, DirectAccess를 사용 하지 않으면 및 클라이언트 요청이 클라이언트 컴퓨터의 네트워크 어댑터에 구성 되어 있는 DNS 서버를 사용 하 여 확인 됩니다.  
  
-   연결에 실패하면 클라이언트가 인트라넷에 있는 것으로 간주됩니다. 이 경우 DirectAccess 클라이언트는 NRPT(이름 확인 정책 테이블)를 사용하여 이름 요청을 확인할 때 사용할 DNS 서버를 결정합니다. 클라이언트에서 DirectAccess DNS64를 사용하여 이름을 확인하거나, 대체 내부 DNS 서버를 사용하도록 지정할 수 있습니다.  
  
이름 확인을 수행할 때 NRPT는 DirectAccess 클라이언트에서 요청을 처리할 방법을 식별하는 데 사용됩니다. 클라이언트는 FQDN 또는 단일 레이블 이름이 요청 같은 <https://internal>합니다. 단일 레이블 이름이 요청된 경우 FQDN을 만들기 위해 DNS 접미사가 추가됩니다. DNS 쿼리가 NRPT의 항목과 일치 하는 경우 DNS4 또는 인트라넷 DNS 서버 항목에 대 한 지정 된 쿼리는 지정된 된 서버를 사용 하 여 이름 확인을 위해 전송 됩니다. 일치 하는 존재 하지만 DNS 서버는 지정 하지 않으면 경우는 예외 규칙을 일반 이름 확인이 적용 됩니다.  
  
클릭 하 여 접미사의 기본 DNS 서버를 자동으로 검색할 수 있습니다 새 접미사가 nrpt는 원격 액세스 관리 콘솔에 추가 되 면 합니다 **검색** 단추입니다. 자동 검색은 다음과 같습니다.  
  
-   회사 네트워크가 IPv4 기반 이거나 IPv4 및 IPv6를 사용, 기본 주소는 원격 액세스 서버에 있는 내부 어댑터의 DNS64 주소입니다.  
  
-   회사 네트워크가 IPv6 기반인 경우 기본 주소는 회사 네트워크에 있는 DNS의 IPv6 주소입니다.  
  
##### <a name="infrastructure-servers"></a>인프라 서버  
  
-   **네트워크 위치 서버**  
  
    DirectAccess 클라이언트는 내부 네트워크에 있는지 확인하기 위해 네트워크 위치 서버에 연결합니다. 내부 네트워크의 클라이언트가 네트워크 위치 서버의 이름을 확인할 수 있어야 하 고 인터넷에 있을 때는 이름을 확인에서 차단 되어야 합니다. 이를 위해 기본적으로 네트워크 위치 서버의 FQDN이 NRPT에 예외 규칙으로 추가됩니다. 또한 원격 액세스를 구성하는 경우 다음 규칙이 자동으로 만들어집니다.  
  
    -   DNS 접미사 루트 도메인 또는 도메인 이름 원격 액세스 서버 및 원격 액세스 서버에 구성 된 인트라넷 DNS 서버에 해당 하는 IPv6 주소에 대 한 규칙입니다. 예를 들어 원격 액세스 서버가 corp.contoso.com 도메인의 구성원인 경우 corp.contoso.com DNS 접미사에 대한 규칙이 만들어집니다.  
  
    -   네트워크 위치 서버의 FQDN에 대한 예외 규칙. 예를 들어 네트워크 위치 서버 URL이 <https://nls.corp.contoso.com>, FQDN nls.corp.contoso.com에 대 한 예외 규칙 생성 됩니다.  
  
-   **IP-HTTPS 서버**  
  
    원격 액세스 서버는 IP-HTTPS 수신기 역할 및 해당 서버 인증서를 사용 하 여 IP-HTTPS 클라이언트를 인증 합니다. IP-HTTPS 이름은 공용 DNS 서버를 사용 하는 DirectAccess 클라이언트에서 확인할 수 있어야 합니다.  
  
##### <a name="connectivity-verifiers"></a>연결 검증 도구  
원격 액세스는 DirectAccess 클라이언트 컴퓨터에서 내부 네트워크에 대한 연결을 확인하는 데 사용하는 기본 웹 검색을 만듭니다. 검색이 정상적으로 작동하려면 다음 이름을 DNS에 수동으로 등록해야 합니다.  
  
-   **directaccess webprobehost** 원격 액세스 서버의 내부 IPv4 주소 또는 IPv6 전용 환경의 IPv6 주소를 확인 합니다.  
  
-   **directaccess corpconnectivityhost** 로컬 호스트 (루프백) 주소를 확인 합니다. A 및 AAAA 레코드를 만들어야 합니다. A 레코드의 값이 127.0.0.1 및 AAAA 레코드의 값이 127.0.0.1로의 마지막 32 비트가 NAT64 접두사에서 생성 됩니다. NAT64 접두사를 실행 하 여 검색할 수는 **Get-netnattransitionconfiguration** Windows PowerShell cmdlet.  
  
    > [!NOTE]  
    > IPv4 전용 환경 에서만에서 유효합니다. IPv4 및 IPv6 또는 IPv6 전용 환경에서 루프백 IP 주소를 사용 하 여 AAAA 레코드만 만들:: 1.  
  
HTTP 또는 PING을 통해 다른 웹 주소를 사용 하 여 추가 연결 검증 도구를 만들 수 있습니다. 각 연결 검증 도구에 대한 DNS 항목이 있어야 합니다.  
  
##### <a name="dns-server-requirements"></a>DNS 서버 요구 사항  
  
-   DirectAccess 클라이언트에 대 한 Windows Server 2012, Windows Server 2008 R2, Windows Server 2008, Windows Server 2003, 또는 IPv6을 지 원하는 DNS 서버를 실행 하는 DNS 서버를 사용 해야 합니다.  
  
-   동적 업데이트를 지 원하는 DNS 서버를 사용 해야 합니다. 동적 업데이트를 지원 하지 않는 DNS 서버를 사용할 수 있지만 다음 항목 수동으로 업데이트 해야 합니다.  
  
-   CRL 배포 지점의 FQDN 인터넷 DNS 서버를 사용 하 여 확인할 수 있어야 합니다. 예를 들어 경우 URL <https://crl.contoso.com/crld/corp-DC1-CA.crl> 에 **CRL 배포 지점** IP-HTTPS 인증서의 필드 원격 액세스 서버의 해야 인터넷 DNS 서버를 사용 하 여 FQDN crld.contoso.com를 확인할 수 있습니다.  
  
#### <a name="plan-for-local-name-resolution"></a>로컬 이름 확인에 대 한 계획  
로컬 이름 확인 하려는 경우에 다음을 고려 합니다.  
  
##### <a name="nrpt"></a>NRPT  
다음과 같은 상황에서 추가 이름 확인 정책 테이블 (NRPT) 규칙을 만들 해야 할 수 있습니다.  
  
-   인트라넷 네임 스페이스에 대 한 DNS 접미사를 추가 해야 합니다.  
  
-   CRL 배포 지점의 Fqdn 인트라넷 네임 스페이스를 기반으로 하는 경우 CRL 배포 지점의 Fqdn에 대 한 예외 규칙을 추가 해야 합니다.  
  
-   스플릿 브레인 DNS 환경을 사용 하는 경우 DirectAccess 클라이언트가 인트라넷 버전 대신 인터넷 버전에 액세스 하려면 인터넷에 있는 하려는 리소스 이름에 대 한 예외 규칙을 추가 해야 합니다.  
  
-   인트라넷 웹 프록시 서버를 통해 외부 웹 사이트로 트래픽을 리디렉션하는, 하는 경우 외부 웹 사이트는 인트라넷 에서만에서 사용할 수 있습니다. 웹 프록시 서버의 주소를 사용 하 여 인바운드 요청을 허용 하도록 합니다. 이 경우 외부 웹 사이트의 FQDN에 대 한 예외 규칙을 추가 하 고 규칙에서는 인트라넷 DNS 서버의 IPv6 주소 대신 인트라넷 웹 프록시 서버를 지정 합니다.  
  
    예를 들어 test.contoso.com 이라는 외부 웹 사이트를 테스트 한다고 가정해 보겠습니다. 이 이름은 인터넷 DNS 서버를 통해 확인할 수 이지만 Contoso 웹 프록시 서버 이름을 확인 하는 방법 및 외부 웹 서버에 웹 사이트에 대 한 요청을 전달 하는 방법을 알고 있습니다. Contoso 인트라넷에 없는 사용자가 사이트에 액세스하지 못하도록 하기 위해 외부 웹 사이트에서는 Contoso 웹 프록시의 IPv4 인터넷 주소에서 보내는 요청만 허용합니다. 따라서 인트라넷 사용자가 Contoso 웹 프록시를 사용 하는 Contoso 웹 프록시를 사용 하지 않는 DirectAccess 사용자가 없으므로 하므로 웹 사이트를 액세스할 수 있습니다. Contoso 웹 프록시를 사용하는 test.contoso.com에 대한 NRPT 예외 규칙을 구성하면 test.contoso.com에 대한 웹 페이지 요청이 IPv4 인트라넷을 통해 인트라넷 웹 프록시 서버로 라우팅됩니다.  
  
##### <a name="single-label-names"></a>단일 레이블 이름  
단일 레이블 이름을와 같은 <https://paycheck>, 인트라넷 서버에 하는 경우가 있습니다. 단일 레이블 이름이 요청 된 경우 DNS 접미사 검색 목록을 구성 되어 있으면 목록에서 DNS 접미사가 단일 레이블 이름에 추가 됩니다. Corp.contoso.com 도메인 형식의 멤버인 컴퓨터 사용자에 예를 들어 <https://paycheck> 웹 브라우저에서 이름으로 생성 된 FQDN은 paycheck.corp.contoso.com 합니다. 기본적으로 추가 되는 접미사는 클라이언트 컴퓨터의 주 DNS 접미사를 기반으로 합니다.  
  
> [!NOTE]  
> 연결 되지 않은 이름 공간 시나리오 (하나 이상의 도메인 컴퓨터에 Active Directory 도메인 컴퓨터 구성원이 되는 일치 하지 않는 DNS 접미사가), 필요한 모든 접미사를 포함 하도록 검색 목록을 사용자 지정는 확인 해야 합니다. 기본적으로 원격 액세스 마법사에서 Active Directory DNS 이름을 클라이언트의 주 DNS 접미사로 구성합니다. 클라이언트에서 이름 확인에 사용하는 DNS 접미사를 추가해야 합니다.  
  
여러 도메인 및 Windows 인터넷 이름 서비스 WINS ()은 조직에 배포 하 고 원격으로 연결 하는 경우 단일 이름 같이 확인할 수 있습니다.  
  
-   DNS에 WINS 정방향 조회 영역을 배포 합니다. Computername.dns.zone1.corp.contoso.com을 확인 하는 동안에 컴퓨터 이름을 사용 하는 WINS 서버로 요청이 전달 됩니다. 클라이언트는 일반 DNS A 레코드 요청을 발급 하는 것 이지만 실제로 NetBIOS 요청 생각 합니다.  
  
    자세한 내용은 [정방향 조회 영역을 관리](https://technet.microsoft.com/library/cc816891(WS.10).aspx)합니다.  
  
-   기본 도메인 GPO에 DNS 접미사 (예: dns.zone1.corp.contoso.com)를 추가 하 여  
  
##### <a name="split-brain-dns"></a>스플릿 브레인(Split-Brain) DNS  
스플릿 브레인 DNS 인터넷 및 인트라넷 이름 확인을 위해 동일한 DNS 도메인의 사용을 가리킵니다.  
  
스플릿 브레인 DNS 배포에 대 한 인터넷 및 인트라넷에 중복 된 리소스를 결정 하는 Fqdn을 나열 해야 도달률은 인트라넷 또는 인터넷 버전 DirectAccess 클라이언트 해야 합니다. DirectAccess 클라이언트가 인터넷 버전에 연결할 때, 각 리소스에 대 한 nrpt 예외 규칙으로 해당 FQDN를 추가 해야 합니다.  
  
스플릿 브레인 DNS 환경에서 리소스를 사용할 수의 두 버전 모두를 하려는 경우 인터넷에서 사용 되는 이름과 중복 되지 않는 이름의 인트라넷 리소스에 구성 합니다. 그런 다음 대체 이름을 사용 하 여 인트라넷의 리소스에 액세스할 때 사용자가 지시 합니다. 예를 들어 www를 구성할\.www의 내부 이름을 internal.contoso.com\.contoso.com입니다.  
  
스플릿 브레인이 아닌 DNS 환경에서는 인터넷 네임스페이스가 인트라넷 네임스페이스와 다릅니다. 예를 들어 인터넷의 네임스페이스는 Contoso Corporation uses contoso.com이고 인트라넷의 네임스페이스는 corp.contoso.com인 경우를 살펴보겠습니다. 모든 인트라넷 리소스는 corp.contoso.com DNS 접미사를 사용하므로 corp.contoso.com에 대한 NRPT 규칙에 따라 인트라넷 리소스에 대한 모든 DNS 이름 쿼리가 인트라넷 DNS 서버로 라우팅됩니다. 접미사가 contoso.com 인 이름에 대 한 DNS 쿼리가 NRPT의 corp.contoso.com intranet 네임 스페이스 규칙과 일치 하지 않습니다 하 고 인터넷 DNS 서버에 전송 합니다. 스플릿 브레인이 아닌 DNS 환경에서는 인트라넷 리소스와 인터넷 리소스의 FQDN이 중복되지 않으므로 NRPT에 대한 추가 구성이 필요 없습니다. DirectAccess 클라이언트는 조직에 대해 인터넷 및 인트라넷 리소스에 액세스할 수 있습니다.  
  
##### <a name="plan-local-name-resolution-behavior-for-directaccess-clients"></a>DirectAccess 클라이언트에 대 한 로컬 이름 확인 동작을 계획  
이름을 DNS에 Windows Server 2012, Windows 8, Windows Server 2008 R2의 DNS 클라이언트 서비스를 사용 하 여 확인할 수 없는 경우 Windows 7에는 NetBIOS over TCP/IP 프로토콜을 확인 하 고 링크-로컬 멀티 캐스트 이름 확인 LLMNR () 사용 하 여 로컬 이름 확인을 사용할 수는  로컬 서브넷의 이름입니다. 로컬 이름 확인은 컴퓨터가 단일 서브넷 홈 네트워크와 같은 프라이빗 네트워크에 있는 경우 일반적으로 피어-투-피어 연결에 필요합니다.  
  
인트라넷 서버 이름에 대 한 로컬 이름 확인을 수행 하는 DNS 클라이언트 서비스를 인터넷에서의 공유 서브넷에 연결 되어 악의적인 사용자가 over TCP/IP 메시지를 인트라넷 서버 이름 확인 LLMNR 및 NetBIOS 캡처할 수 있습니다. 인프라 서버 설치 마법사의 DNS 페이지에서 인트라넷 DNS 서버에서 받은 응답 유형에 따라 로컬 이름 확인 동작을 구성할 수 있습니다. 사용할 수 있는 옵션은 다음과 같습니다.  
  
-   **이름을 DNS에 존재 하지 않는 경우 로컬 이름 확인을 사용 하 여**: 이 옵션은 DirectAccess 클라이언트가 인트라넷 DNS 서버에서 확인할 수 없는 서버 이름에 대해서만 로컬 이름 확인을 수행하기 때문에 가장 안전합니다. 인트라넷 DNS 서버에 연결할 수 있는 경우 인트라넷 서버의 이름이 확인됩니다. 인트라넷 DNS 서버에 연결할 수 없거나 다른 유형의 DNS 오류가 있는 경우에는 인트라넷 서버 이름이 로컬 이름 확인을 통해 서브넷에 유출되지 않습니다.  
  
-   **이름을 DNS에 존재 하지 않거나 클라이언트 컴퓨터가 개인 네트워크 (권장)에 있을 때 DNS 서버에 연결할 수 없는 경우 로컬 이름 확인을 사용 하 여**: 이 옵션은 인트라넷 DNS 서버에 연결할 수 없는 경우에만 프라이빗 네트워크에서 로컬 이름 확인을 사용하도록 허용하기 때문에 권장되는 옵션입니다.  
  
-   **모든 종류의 DNS 확인 오류 (가장 취약)에 대 한 로컬 이름 확인을 사용 하 여**: 인트라넷 네트워크 서버의 이름이 로컬 이름 확인을 통해 로컬 서브넷에 유출될 수 있으므로 보안 수준이 가장 낮은 옵션입니다.  
  
#### <a name="plan-the-network-location-server-configuration"></a>네트워크 위치 서버 구성 계획  
네트워크 위치 서버는 DirectAccess 클라이언트가 회사 네트워크에 있는지 여부를 검색 하는 데 사용 되는 웹 사이트입니다. 회사 네트워크의 클라이언트가 내부 리소스에 연결할 DirectAccess를 사용 하지 않는 하지만 대신 직접 연결 합니다.  
  
조직에서 다른 서버 또는 원격 액세스 서버의 네트워크 위치 서버 웹 사이트를 호스트할 수 있습니다. 원격 액세스 서버의 네트워크 위치 서버를 호스트 하는 경우 원격 액세스를 배포 하는 경우 웹 사이트를 자동으로 만들어집니다. Windows 운영 체제를 실행 하는 다른 서버의 네트워크 위치 서버를 호스트 하는 경우 해당 서버에서 인터넷 정보 서비스 (IIS)가 설치 되어 있는 웹 사이트가 만들어집니다 있는지 확인 해야 합니다. 원격 액세스는 네트워크 위치 서버의 설정을 구성 하지 않습니다.  
  
네트워크 위치 서버 웹 사이트는 다음 요구 사항을 충족 하는지 확인 합니다.  
  
-   HTTPS 서버 인증서를 있습니다.  
  
-   내부 네트워크에 고가용성이 컴퓨터에 있습니다.  
  
-   인터넷의 DirectAccess 클라이언트 컴퓨터에 액세스할 수 없는 경우  
  
-  
  
또한 네트워크 위치 서버 웹 사이트를 설정 하는 경우 클라이언트에 대 한 다음 요구 사항을 것이 좋습니다.  
  
-   DirectAccess 클라이언트 컴퓨터가 네트워크 위치 서버 웹 사이트에 서버 인증서를 발급한 CA를 신뢰해야 합니다.  
  
-   내부 네트워크의 DirectAccess 클라이언트 컴퓨터에서 네트워크 위치 서버 사이트의 이름을 확인할 수 있어야 합니다.  
  
##### <a name="plan-certificates-for-the-network-location-server"></a>네트워크 위치 서버용 인증서 계획  
네트워크 위치 서버에 사용할 웹 사이트 인증서를 가져온 경우 다음을 고려 합니다.  
  
-   에 **주체** 필드에 네트워크 위치 서버의 인트라넷 인터페이스 또는 네트워크 위치 URL의 FQDN의 IP 주소를 지정 합니다.  
  
-   에 대 한 합니다 **향상 된 키 용도** 필드에 서버 인증 OID를 사용 합니다.  
  
-   네트워크 위치 서버 인증서를 인증서 해지 목록 (CRL)을 검사 해야 합니다. 에 대 한 합니다 **CRL 배포 지점** 필드, 인트라넷에 연결 된 DirectAccess 클라이언트에서 액세스할 수 있는 CRL 배포 지점을 사용 합니다. 이 CRL 배포 지점에는 내부 네트워크 외부에서 액세스할 수 없습니다.  
  
##### <a name="plan-dns-for-the-network-location-server"></a>네트워크 위치 서버용 DNS 계획  
DirectAccess 클라이언트는 내부 네트워크에 있는지 확인하기 위해 네트워크 위치 서버에 연결합니다. 내부 네트워크의 클라이언트는 네트워크 위치 서버의 이름을 확인할 수 있어야 하지만, 인터넷에 있을 때는 이름을 확인하지 못하도록 설정되어야 합니다. 이를 위해 기본적으로 네트워크 위치 서버의 FQDN이 NRPT에 예외 규칙으로 추가됩니다.  
  
### <a name="plan-management-servers-configuration"></a>관리 서버 구성 계획  
DirectAccess 클라이언트는 Windows 업데이트 및 바이러스 백신 업데이트와 같은 서비스를 제공 하는 관리 서버와의 통신을 시작 합니다. 또한 DirectAccess 클라이언트가 내부 네트워크에 액세스 하기 전에 도메인 컨트롤러에 인증 하 Kerberos 프로토콜을 사용 합니다. DirectAccess 클라이언트의 원격 관리 중에 관리 서버는 클라이언트 컴퓨터와 통신하여 소프트웨어 또는 하드웨어 인벤토리 평가와 같은 관리 기능을 수행합니다. 원격 액세스에서는 다음을 비롯한 일부 관리 서버를 자동으로 검색할 수 있습니다.  
  
-   도메인 컨트롤러: 도메인 컨트롤러의 자동 검색은 클라이언트 컴퓨터를 포함 하는 도메인을 원격 액세스 서버와 동일한 포리스트에 있는 모든 도메인에 대해 수행 됩니다.  
  
-   System Center Configuration Manager 서버  
  
도메인 컨트롤러 및 System Center Configuration Manager 서버는 처음으로 DirectAccess를 자동으로 검색 구성 됩니다. 검색 된 도메인 컨트롤러가 콘솔에서 표시 되지 않지만 Windows PowerShell cmdlet을 사용 하 여 설정을 검색할 수 있습니다. 도메인 컨트롤러 또는 System Center Configuration Manager 서버가 수정 클릭 **업데이트 관리 서버** 콘솔에서 관리 서버 목록을 새로 고칩니다.  
  
**Management server 요구 사항**  
  
-   관리 서버는 인프라 터널을 통해 액세스할 수 있어야 합니다. 원격 액세스를 구성할 때 관리 서버 목록에 서버를 추가하면 이 터널을 통해 해당 서버에 액세스할 수 있도록 자동으로 설정됩니다.  
  
-   완벽 하 게 DirectAccess 클라이언트 연결을 시작 하는 관리 서버는 기본 IPv6 주소를 통해 또는 ISATAP를 통해 할당 된 주소를 사용 하 여 IPv6을 지원 해야 합니다.  
  
### <a name="plan-active-directory-requirements"></a>Active Directory 요구 사항 계획  
원격 액세스는 다음과 같이 Active Directory를 사용합니다.  
  
-   **인증**: 인프라 터널 NTLMv2 인증을 사용 하 여 원격 액세스 서버에 연결 하는 컴퓨터 계정의 및 Active Directory 도메인 계정 이어야 합니다. 인트라넷 터널 사용자에 대 한 Kerberos 인증을 사용 하 여 인트라넷 터널을 만듭니다.  
  
-   **그룹 정책 개체**: 원격 액세스는 원격 액세스 서버, 클라이언트 및 내부 응용 프로그램 서버에 적용 되는 그룹 정책 개체 (Gpo)에 구성 설정을 수집 합니다.  
  
-   **보안 그룹**: 원격 액세스 보안 그룹을 사용 하 여 수집 하 고 DirectAccess 클라이언트 컴퓨터를 식별 합니다. Gpo는 필요한 보안 그룹에 적용 됩니다.  
  
원격 액세스 배포에 대 한 Active Directory 환경을 계획할 때 다음 요구 사항을 고려 합니다.  
  
-   하나 이상의 도메인 컨트롤러는 Windows Server 2012, Windows Server 2008 R2 Windows Server 2008 또는 Windows Server 2003 운영 체제에 설치 됩니다.  
  
    도메인 컨트롤러가 경계 네트워크 (및 따라서 원격 액세스 서버의 인터넷 연결 네트워크 어댑터에서 연결할 수 있는) 인 경우 원격 액세스 서버에서 방지 합니다. 인터넷 어댑터의 IP 주소에 대 한 연결을 방지 하기 위해 도메인 컨트롤러에서 패킷 필터를 추가 해야 합니다.  
  
-   원격 액세스 서버가 도메인 구성원이어야 합니다.  
  
-   DirectAccess 클라이언트가 도메인 구성원이어야 합니다. 클라이언트는 다음에 속할 수 있습니다.  
  
    -   원격 액세스 서버와 동일한 포리스트의 모든 도메인  
  
    -   원격 액세스 서버 도메인과 양방향 트러스트 관계에 있는 모든 도메인  
  
    -   원격 액세스 서버 도메인의 포리스트와 양방향 트러스트 관계가 있는 포리스트의 모든 도메인입니다.  
  
> [!NOTE]  
> -   원격 액세스 서버는 도메인 컨트롤러일 수 없습니다.  
> -   원격 액세스에 사용 되는 Active Directory 도메인 컨트롤러 (어댑터에에서 없어야 Windows 방화벽의 도메인 프로필) 원격 액세스 서버의 외부 인터넷 어댑터에서 연결할 수 없습니다.  
  
#### <a name="plan-client-authentication"></a>클라이언트 인증 계획  
Windows Server 2012의 원격 액세스에서 사용자 이름 및 암호를 사용 하는 기본 제공 Kerberos 인증을 사용 하 여 또는 IPsec 컴퓨터 인증용 인증서를 사용 하 여 간에 선택할 수 있습니다.  
  
**Kerberos 인증**: 인증에 대 한 Active Directory 자격 증명을 사용 하려는 경우 먼저 DirectAccess 컴퓨터에 대 한 Kerberos 인증을 사용 하 고 사용자에 대 한 Kerberos 인증을 사용 합니다. 이 인증 모드를 사용 하는 경우 DirectAccess에서는 내부 네트워크에 DNS 서버, 도메인 컨트롤러 및 다른 서버에 대 한 액세스를 제공 하는 단일 보안 터널을 사용 하는  
  
**IPsec 인증**: 2 단계 인증 또는 네트워크 액세스 보호를 사용 하려는 경우 DirectAccess는 두 개의 보안 터널을 사용 합니다. 원격 액세스 설치 마법사에서 고급 보안이 포함 된 Windows 방화벽 연결 보안 규칙을 구성합니다. 이러한 규칙 IPsec 보안 원격 액세스 서버를 협상할 때 다음 자격 증명을 지정 합니다.  
  
-   인프라 터널 첫 번째 인증 및 두 번째 인증에 대 한 사용자 (NTLMv2) 자격 증명에 대 한 컴퓨터 인증서 자격 증명을 사용합니다. 사용자 자격 증명 인증 된 인터넷 프로토콜 (AuthIP)를 사용 하도록 하 고 DirectAccess 클라이언트가 인트라넷 터널에 대 한 Kerberos 자격 증명을 사용 하려면 먼저 DNS 서버 및 도메인 컨트롤러에 대 한 액세스를 제공 합니다.  
  
-   인트라넷 터널 첫 번째 인증 및 두 번째 인증 (Kerberos V5) 사용자 자격 증명에 대 한 컴퓨터 인증서 자격 증명을 사용합니다.  
  
#### <a name="plan-multiple-domains"></a>여러 도메인 계획  
관리 서버 목록에는 DirectAccess 클라이언트 컴퓨터가 포함된 보안 그룹을 포함하는 모든 도메인의 도메인 컨트롤러가 포함되어야 합니다. DirectAccess 클라이언트로 구성 하는 컴퓨터를 사용할 수 있는 사용자 계정을 포함 하는 모든 도메인이 있어야 합니다. 그러면 사용 중인 클라이언트 컴퓨터와 동일한 도메인에 있지 않은 사용자가 사용자 도메인의 도메인 컨트롤러로 인증을 받을 수 있게 됩니다.  
  
이 인증은 도메인이 동일한 포리스트에 있는 경우 자동입니다. 클라이언트 컴퓨터 또는 서로 다른 포리스트에 있는 응용 프로그램 서버를 사용 하 여 보안 그룹의 경우 해당 포리스트의 도메인 컨트롤러 자동으로 검색 되지 않습니다. 포리스트 또한 하지 자동으로 검색 됩니다. 작업을 실행할 수 있습니다 **업데이트 관리 서버** 에 **원격 액세스 관리** 이러한 도메인 컨트롤러를 검색할 합니다.  
  
가능한 경우 원격 액세스 배포 중 nrpt 공통 도메인 이름 접미사에 추가 되어야 합니다. 예를 들어 두 개의 도메인 domain1.corp.contoso.com과 domain2.corp.contoso.com이 있는 경우 NRPT에 두 항목을 추가하는 대신 공통 DNS 접미사 항목(여기서 도메인 이름 접미사는 corp.contoso.com)을 추가할 수 있습니다. 이 동일한 루트 도메인에 대 한 자동으로 발생합니다. 동일한 루트에 있지 않은 도메인을 수동으로 추가 되어야 합니다.  
  
### <a name="plan-group-policy-object-creation"></a>그룹 정책 개체 만들기 계획  
원격 액세스를 구성 하는 경우 DirectAccess 설정은 그룹 정책 개체 (Gpo)에 수집 됩니다. Gpo를 두 개는 DirectAccess 설정으로 채워지며 다음과 같이 배포:  
  
-   **DirectAccess 클라이언트 GPO**: 이 GPO는 IPv6 전환 기술 설정, NRPT 항목 및 연결 보안 규칙을 포함 하 여 고급 보안이 포함 된 Windows 방화벽에 대 한 클라이언트 설정을 포함 합니다. 클라이언트 컴퓨터에 지정된 보안 그룹에 적용됩니다.  
  
-   **DirectAccess 서버 GPO**: 이 GPO는 배포에서 원격 액세스 서버로 구성 된 모든 서버에 적용 되는 DirectAccess 구성 설정을 포함 합니다. 또한 고급 보안이 포함 된 Windows 방화벽에 대 한 연결 보안 규칙을 포함 합니다.  
  
> [!NOTE]  
> 클라이언트 응용 프로그램 서버에 있는 DirectAccess 서버의 내부 네트워크에 액세스할 수 없으므로 응용 프로그램 서버의 구성은 DirectAccess 클라이언트의 원격 관리에 지원 되지 않습니다. 4 단계 원격 액세스 설정 구성 화면에서이 구성의이 형식에 대 한 제공 되지 않습니다.  
  
자동 또는 수동으로 Gpo를 구성할 수 있습니다.  
  
**자동으로**: Gpo를 자동으로 생성 되는 지정 하는 경우 각 GPO에 대 한 기본 이름이 지정 됩니다.  
  
**수동으로**: Active Directory 관리자가 미리 정의한 Gpo를 사용할 수 있습니다.  
  
Gpo를 구성할 때 다음 경고를 고려 합니다.  
  
-   DirectAccess가 특정 GPO를 사용하도록 구성된 후에는 다른 GPO를 사용하도록 구성할 수 없습니다.  
  
-   DirectAccess cmdlet을 실행 하기 전에 모든 원격 액세스 그룹 정책 개체를 백업 하려면 다음 절차를 따르십시오.  
  
    [원격 액세스 구성 백업 및 복원](https://go.microsoft.com/fwlink/?LinkID=257928) 절차에 따라 모든 원격 액세스 GPO를 백업합니다.  
  
-   자동으로 사용 하는지 여부 또는 수동으로 구성 된 Gpo, 클라이언트에서 3g를 사용 하는 경우 저속 연결 검색에 대 한 정책을 추가 해야 합니다. 에 대 한 경로 **정책: 그룹 정책 저속 연결 검색 구성** 됩니다.  
  
    **컴퓨터 구성/정책/관리 템플릿/시스템/그룹 정책**입니다.  
  
-   Gpo 연결에 대 한 올바른 권한이 없으면 경고가 발생 합니다. 원격 액세스 작업이 계속 됩니다, 되지만 연결이 발생 하지 않습니다. 이 경고는 발생 하는 경우 링크 나중에 권한을 추가한 경우에 자동으로 생성 되지 않습니다. 대신 관리자가 수동으로 연결을 만들어야 합니다.  
  
#### <a name="automatically-created-gpos"></a>자동으로 만들어진 Gpo  
만든 Gpo를 자동으로 사용 하는 경우 다음을 고려 합니다.  
  
자동으로 만든 GPO 위치와 링크 대상에 따라 다음과 같이 적용 됩니다.  
  
-   DirectAccess 서버 GPO에 대 한 위치와 링크 대상 원격 액세스 서버를 포함 하는 도메인을 가리킵니다.  
  
-   클라이언트 및 응용 프로그램 서버 Gpo를 만들면 단일 도메인으로 위치가 설정 됩니다. GPO 이름은 각 도메인에서 조회 되며 하 고 있는 경우 DirectAccess 설정을 사용 하 여 도메인 채워집니다.  
  
-   연결 대상은 GPO가 만들어진 도메인의 루트로 설정됩니다. GPO는 클라이언트 컴퓨터 또는 응용 프로그램 서버가 포함된 각 도메인에 만들어지며 각 도메인의 루트에 연결됩니다.  
  
만들어지면 자동으로 사용 하 여 DirectAccess 설정을 적용 하려면 Gpo 원격 액세스 서버 관리자는 다음 권한이 필요 합니다.  
  
-   각 도메인에 대 한 Gpo 만들기 권한입니다.  
  
-   모든 선택한 클라이언트 도메인 루트에 연결할 권한입니다.  
  
-   서버 GPO 도메인 루트에 연결할 권한입니다.  
  
-   를 만들려면 보안 권한을 편집, 삭제 및 Gpo를 수정 합니다.  
  
-   GPO 읽기 권한이 필요한 각 도메인에 대 한 합니다. 이 권한이 필요 하지 않습니다. 하지만 원격 액세스 Gpo를 만들 때 이름이 중복 된 Gpo 존재 하지 않도록 할 수 있기 때문에 것이 좋습니다.  
  
#### <a name="manually-created-gpos"></a>수동으로 만든 Gpo  
수동으로 만든 GPO를 사용할 때 고려할 사항은 다음과 같습니다.  
  
-   원격 액세스 설치 마법사를 실행하기 전에 GPO가 존재해야 합니다.  
  
-   DirectAccess 설정을 적용 하려면 원격 액세스 서버 관리자는 만들기, 편집, 삭제 및 수동으로 만든된 Gpo를 수정 하려면 전체 보안 권한이 필요 합니다.  
  
-   전체 도메인에서 GPO에 대 한 링크 검색이 이루어집니다. GPO가 도메인에 연결되지 않은 경우 자동으로 도메인 루트에 연결이 만들어집니다. 연결을 만드는 데 필요한 권한이 없으면 경고가 발생합니다.  
  
#### <a name="recovering-from-a-deleted-gpo"></a>삭제된 GPO 복구  
원격 액세스 서버, 클라이언트 또는 응용 프로그램 서버 GPO를 실수로 삭제 된 경우 다음 오류 메시지가 표시 됩니다. **GPO (GPO 이름)을 찾을 수 없습니다**합니다.  
  
그러나 백업을 사용할 수 있는 경우 백업에서 GPO를 복구할 수 있습니다. 사용할 수 있는 백업이 없으면 구성 설정을 제거 하며 다시 구성 합니다.  
  
###### <a name="to-remove-configuration-settings"></a>구성 설정을 제거 하려면  
  
1.  Windows PowerShell cmdlet을 실행 **Uninstall-remoteaccess**합니다.  
  
2.  오픈 **원격 액세스 관리**합니다.  
  
3.  GPO를 찾을 수 없다는 오류 메시지가 표시됩니다. **구성 설정 제거**를 클릭합니다. 작업이 완료 되 면 서버가 구성 되지 않은 상태로 복원 됩니다 및 설정을 다시 구성할 수 있습니다.  
  


